<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Serfling Model Background • flumodelr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Serfling Model Background">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flumodelr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01-introduction.html">flumodelr: Introduction</a>
    </li>
    <li>
      <a href="../articles/02-data.html">flumodelr: Data</a>
    </li>
    <li>
      <a href="../articles/03-ratediff.html">Incidence rate-difference models</a>
    </li>
    <li>
      <a href="../articles/04-serfling.html">Serfling Model Background</a>
    </li>
    <li>
      <a href="../articles/05-modserf.html">Modified Serfling Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kmcconeghy/flumodelr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Serfling Model Background</h1>
                        <h4 class="author">Kevin W. McConeghy</h4>
            
            <h4 class="date">2019-06-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kmcconeghy/flumodelr/blob/master/vignettes/04-serfling.Rmd"><code>vignettes/04-serfling.Rmd</code></a></small>
      <div class="hidden name"><code>04-serfling.Rmd</code></div>

    </div>

    
    
<p>The primary method paper was a 1963 paper published by Robert Serfling working for the Centers for Disease Control and Prevention.</p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1915276/">Serfling RE. Methods for current statistical analysis of excess pneumonia-influenza deaths. Public Health Rep. 1963 Jun; 78(6): 494 - 506.</a></p>
<p>The paper outlines a strategy for estimating what proportion of deaths are due to influenza. The underlying issue is that many deaths reported due to influenza and pneumonia may be due to other causes, while many deaths attritable other causes may be due to influenza. The primary goal was to develop a “standard curve of expected seasonal mortality”. The concept was that an individual could use historical data to estimate seasonal trends in influenza. Then for a given place-time an researcher could evaluate how many deaths occurred in excess of this baseline rate. Much of the original paper is of little interest given modern computing methods, but the basic concept persists as a reasonable approach to estimating “flu” deaths.</p>
<div id="influenza" class="section level2">
<h2 class="hasAnchor">
<a href="#influenza" class="anchor"></a>Influenza</h2>
<p>Critically, it should be understood that influenza epidemics are highly seasonal with spikes in the winter months, commonly January - February. This seasonality leads to a cyclical rate of influenza morbidity and mortality.</p>
<p>It was noted by early researchers that the rate of reported deaths (red line), may be modeled by a trigonomic function.</p>
</div>
<div id="linear-and-cyclical-regression-models" class="section level2">
<h2 class="hasAnchor">
<a href="#linear-and-cyclical-regression-models" class="anchor"></a>Linear and Cyclical Regression Models</h2>
<p>The classical ordinary least squares framework is often described in matrix notation as:<br><span class="math display">\[y_i = X_i\beta + u_{i} \quad \textrm{where} \quad i = 1,..,n\]</span></p>
<p>Where <span class="math inline">\(y\)</span> is a dependent variable, <span class="math inline">\(X\)</span> is a vector of regressors (i.e. independent variables) with <span class="math inline">\(k\)</span>-dimensions, <span class="math inline">\(\beta\)</span> is a vector of the coefficients for <span class="math inline">\(X\)</span>, and <span class="math inline">\(u\)</span> is the residual error term. often simply as: <span class="math inline">\(y= X\beta+u\)</span>.</p>
<p>Given a simple additive model with one independent variable t: <span class="math display">\[Eq \ 1. \  y = \alpha_0 + \beta_1*t_1 + u\]</span></p>
<p>Let t, be the unit of time in figure 1 (week = 1, week=2, …). The above model is inadequate, and will poorly fit the data (figure) because the secular trend is non-linear.<br><img src="04-serfling_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Early investigators such as Serfling proposed that a Fourier term be added to model the cycle like so: <span class="math display">\[Eq \ 2. \  y = \alpha_0 + \beta_1*t + sine(\frac{2 \pi t}{52}) + cos(\frac{2 \pi t}{52}) + u\]</span> The original paper used 4-week periods so the period denominator is 13. This allows us to use a linear model which accounts for the cyclical nature of the disease. The original paper recommends one <a href="https://en.wikipedia.org/wiki/Fourier_series">Fourier term</a>.</p>
<div id="model-1-original-serfling-model" class="section level3">
<h3 class="hasAnchor">
<a href="#model-1-original-serfling-model" class="anchor"></a>Model 1: Original Serfling Model</h3>
<p>The basic linear equation is like so: <span class="math display">\[Y = beta_0*\alpha + beta_1*t + beta_6*cos(\frac{2 \pi t}{52}) + beta_7*sin(\frac{2 \pi t}{52})\]</span> Where in our weekly CDC data, t is a single week, with a 52 week cycle. In the original paper it was 4-week periods, with 13 per annual cycle.</p>
</div>
<div id="method-1-endemic-baseline" class="section level3">
<h3 class="hasAnchor">
<a href="#method-1-endemic-baseline" class="anchor"></a>Method 1: Endemic baseline</h3>
<p>Select a season of low epidemicity:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df_cdc, <span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">"%Y"</span>), <span class="dt">date_breaks=</span><span class="st">"1 year"</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">               <span class="dt">expand=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">.9</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Year"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"No. of Deaths from P&amp;I"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">"Figure 1. Pneumonia and Influenza Mortality"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12">g1</a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>2011 / 2012 is period of lowest influenza activity, so taken as the baseline.</p>
<p>This season was used to estimate parameters for the above equation then fit to a future season.</p>
<div id="estimate-model-for-2011-2012-season" class="section level4">
<h4 class="hasAnchor">
<a href="#estimate-model-for-2011-2012-season" class="anchor"></a>Estimate model for 2011 / 2012 season</h4>
<ul>
<li>fitting one season<br>
</li>
<li>one fourier term</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">df_low &lt;-<span class="st"> </span>df_cdc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(yrweek_dt <span class="op">&gt;=</span><span class="st"> </span><span class="kw">ymd</span>(<span class="st">'2011-10-01'</span>) <span class="op">&amp;</span><span class="st"> </span>yrweek_dt <span class="op">&lt;=</span><span class="st"> </span><span class="kw">ymd</span>(<span class="st">'2012-09-30'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">t =</span> <span class="kw">row_number</span>(), <span class="co">#set origin to october</span></a>
<a class="sourceLine" id="cb2-4" title="4">         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>t <span class="op">/</span><span class="st"> </span><span class="dv">52</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">         <span class="dt">sin_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sinpi</a></span>(theta),</a>
<a class="sourceLine" id="cb2-6" title="6">         <span class="dt">cos_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cospi</a></span>(theta)) </a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(fludeaths <span class="op">~</span><span class="st"> </span>t <span class="op">+</span><span class="st"> </span>sin_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>cos_<span class="dv">2</span>, <span class="co">#note the 0 term</span></a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="dt">data=</span>df_low, <span class="dt">na.action =</span> na.exclude) -&gt;<span class="st"> </span>mod_<span class="dv">1</span>_low </a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(mod_<span class="dv">1</span>_low)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; lm(formula = fludeaths ~ t + sin_2 + cos_2, data = df_low, na.action = na.exclude)</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt; -177.38  -20.04    2.51   39.62   93.34 </span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">#&gt; (Intercept)  678.376     21.969  30.879  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt; t              1.674      0.763   2.194    0.033 *  </span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#&gt; sin_2        116.764     16.593   7.037 5.82e-09 ***</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#&gt; cos_2        -99.431     10.801  -9.206 2.91e-12 ***</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co">#&gt; Residual standard error: 55.53 on 49 degrees of freedom</span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="co">#&gt; Multiple R-squared:  0.7564, Adjusted R-squared:  0.7415 </span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="co">#&gt; F-statistic: 50.73 on 3 and 49 DF,  p-value: 4.649e-15</span></a></code></pre></div>
<p><code>sin_2</code> is the Fourier term: sin (2<em><span class="math display">\[\pi\]</span></em>t) / L where L is length of cycle (i.e. 52 weeks)<br>
Fourier series can be iteratively explored for best fit by adjusting the harmonic formula.</p>
<p>Inclusion of biannual or monthly cycles can be done with additional Fourier terms.</p>
<p>E.g. With semi-annual Fourier term:</p>
<p><span class="math display">\[Y = beta_0*\alpha + beta_1*t + 
beta_6*cos(\frac{2 \pi t}{52}) + beta_7*sin(\frac{2 \pi t}{52}) 
+ beta_8*cos(\frac{2 \pi t}{26}) + beta_9*sin(\frac{2 \pi t}{26})\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">df_low_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/warning">suppressWarnings</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(mod_<span class="dv">1</span>_low, <span class="dt">se.fit=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb3-2" title="2">          <span class="dt">interval=</span><span class="st">"prediction"</span>, <span class="dt">level=</span><span class="fl">0.90</span>)) </a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4">df_low &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df_low, <span class="dt">pred_yhat_0 =</span> df_low_pred<span class="op">$</span>fit[, <span class="st">'fit'</span>])</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">g_mod_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df_low) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_<span class="dv">0</span>), <span class="dt">linetype=</span><span class="st">'dashed'</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color =</span> <span class="st">'blue'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">"%Y"</span>), <span class="dt">date_breaks=</span><span class="st">"1 year"</span>,</a>
<a class="sourceLine" id="cb3-10" title="10">               <span class="dt">expand=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">.9</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Year"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"No. of deaths"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">"Figure 2. Original Serfling equation fit to 2011/12"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-17" title="17"></a>
<a class="sourceLine" id="cb3-18" title="18">g_mod_<span class="dv">1</span></a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The fit works well for this particular period.</p>
</div>
<div id="apply-model-estimates-to-fit-2012-2013-year-" class="section level4">
<h4 class="hasAnchor">
<a href="#apply-model-estimates-to-fit-2012-2013-year-" class="anchor"></a>Apply model estimates to fit 2012 / 2013 year.</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">df_high &lt;-<span class="st"> </span>df_cdc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(yrweek_dt <span class="op">&gt;=</span><span class="st"> </span><span class="kw">ymd</span>(<span class="st">'2012-10-01'</span>) <span class="op">&amp;</span><span class="st"> </span>yrweek_dt <span class="op">&lt;=</span><span class="st"> </span><span class="kw">ymd</span>(<span class="st">'2013-09-30'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">t =</span> <span class="kw">row_number</span>(), <span class="co">#set origin to october</span></a>
<a class="sourceLine" id="cb4-4" title="4">         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>t <span class="op">/</span><span class="st"> </span><span class="dv">52</span>,</a>
<a class="sourceLine" id="cb4-5" title="5">         <span class="dt">sin_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sinpi</a></span>(theta),</a>
<a class="sourceLine" id="cb4-6" title="6">         <span class="dt">cos_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cospi</a></span>(theta)) </a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8">df_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(mod_<span class="dv">1</span>_low, <span class="dt">newdata=</span>df_high, <span class="dt">se.fit=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb4-9" title="9">           <span class="dt">interval=</span><span class="st">"prediction"</span>, <span class="dt">level=</span><span class="fl">0.90</span>)  </a>
<a class="sourceLine" id="cb4-10" title="10"></a>
<a class="sourceLine" id="cb4-11" title="11">pred_yhat_<span class="dv">0</span> &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">1</span>] <span class="co">#fitted values</span></a>
<a class="sourceLine" id="cb4-12" title="12">pred_yhat_upr &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">3</span>] </a>
<a class="sourceLine" id="cb4-13" title="13"></a>
<a class="sourceLine" id="cb4-14" title="14">df_mod_<span class="dv">1</span> &lt;-<span class="st"> </span>df_high <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="st">  </span><span class="kw">add_column</span>(., pred_yhat_<span class="dv">0</span>, pred_yhat_upr)  </a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">g_mod_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df_mod_<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_<span class="dv">0</span>), <span class="dt">linetype=</span><span class="st">'dashed'</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color =</span> <span class="st">'blue'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_upr), <span class="dt">linetype=</span><span class="st">'dotted'</span>, <span class="dt">color=</span><span class="st">'red'</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">"%Y"</span>), <span class="dt">date_breaks=</span><span class="st">"1 year"</span>,</a>
<a class="sourceLine" id="cb5-6" title="6">               <span class="dt">expand=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">.9</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Year"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"No. of deaths"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">"Figure 3. 2011/12 estimates fitted to 2012/13 season"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb5-13" title="13"></a>
<a class="sourceLine" id="cb5-14" title="14">g_mod_<span class="dv">1</span></a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Gray - observed deaths<br>
Blue dash - fitted curved for 2011 / 2012, applied to 2012 / 2013 Red dotted - upper 90% prediction interval</p>
<p>In the original paper, deaths exceeding the 90% interval would be considered in excess, and if two consecutive weeks occurred than that was a ‘epidemic’.</p>
<p>However, it was noted in the paper this was less practical when consecutive years occur without a very low endemicity flu season. An alternative approach was given that is more generalizable.</p>
</div>
<div id="method-2-secular-trend-differencing" class="section level4">
<h4 class="hasAnchor">
<a href="#method-2-secular-trend-differencing" class="anchor"></a>Method 2: Secular trend differencing</h4>
<p>One approach is to estimate the model using the previous 5 years of data. Assuming this will average out epidemics and give a baseline measure of activity.</p>
<ul>
<li>Fit a model using first 4 seasons, apply to 5th season</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">df_cdc_<span class="dv">2</span>  &lt;-<span class="st"> </span>df_cdc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(fluyr<span class="op">&lt;</span><span class="dv">2014</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">t =</span> <span class="kw">row_number</span>(), <span class="co">#set origin to october</span></a>
<a class="sourceLine" id="cb6-4" title="4">         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>t <span class="op">/</span><span class="st"> </span><span class="dv">52</span>,</a>
<a class="sourceLine" id="cb6-5" title="5">         <span class="dt">sin_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sinpi</a></span>(theta),</a>
<a class="sourceLine" id="cb6-6" title="6">         <span class="dt">cos_2 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cospi</a></span>(theta)) </a>
<a class="sourceLine" id="cb6-7" title="7"></a>
<a class="sourceLine" id="cb6-8" title="8">mod_<span class="dv">1</span>_sec_fit &lt;-<span class="st"> </span>df_cdc_<span class="dv">2</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(fludeaths <span class="op">~</span><span class="st"> </span>t <span class="op">+</span><span class="st"> </span>sin_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>cos_<span class="dv">2</span>, <span class="co">#note the 0 term</span></a>
<a class="sourceLine" id="cb6-10" title="10">    <span class="dt">data=</span>., <span class="dt">na.action =</span> na.exclude) </a>
<a class="sourceLine" id="cb6-11" title="11"></a>
<a class="sourceLine" id="cb6-12" title="12">df_pred &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(mod_<span class="dv">1</span>_sec_fit, <span class="dt">newdata =</span> df_cdc, <span class="dt">se.fit=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb6-13" title="13">           <span class="dt">interval=</span><span class="st">"prediction"</span>, <span class="dt">level=</span><span class="fl">0.90</span>)  </a>
<a class="sourceLine" id="cb6-14" title="14"></a>
<a class="sourceLine" id="cb6-15" title="15">pred_yhat_<span class="dv">0</span> &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">1</span>] <span class="co">#fitted values</span></a>
<a class="sourceLine" id="cb6-16" title="16">pred_yhat_upr &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">3</span>] </a>
<a class="sourceLine" id="cb6-17" title="17"></a>
<a class="sourceLine" id="cb6-18" title="18">df_mod_<span class="dv">1</span>_sec &lt;-<span class="st"> </span>df_cdc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="st">  </span><span class="kw">add_column</span>(., pred_yhat_<span class="dv">0</span>, pred_yhat_upr)  </a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">g_mod_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df_mod_<span class="dv">1</span>_sec[df_mod_<span class="dv">1</span>_sec<span class="op">$</span>fluyr<span class="op">&lt;</span><span class="dv">2014</span>, ]) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_<span class="dv">0</span>), <span class="dt">linetype=</span><span class="st">'dashed'</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color =</span> <span class="st">'blue'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_upr), <span class="dt">linetype=</span><span class="st">'dotted'</span>, <span class="dt">color=</span><span class="st">'red'</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">"%Y"</span>), <span class="dt">date_breaks=</span><span class="st">"1 year"</span>,</a>
<a class="sourceLine" id="cb7-6" title="6">               <span class="dt">expand=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">.9</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Year"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"No. of deaths"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">"Figure 3. 2010 - 2014 estimates fitted"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-13" title="13"></a>
<a class="sourceLine" id="cb7-14" title="14">g_mod_<span class="dv">1</span></a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<p>Model fit from first four seasons, notice the 2012 / 2013 season does not fit the curve well.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">g_mod_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df_mod_<span class="dv">1</span>_sec[df_mod_<span class="dv">1</span>_sec<span class="op">$</span>fluyr<span class="op">==</span><span class="dv">2014</span>, ]) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_<span class="dv">0</span>), <span class="dt">linetype=</span><span class="st">'dashed'</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">color =</span> <span class="st">'blue'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>pred_yhat_upr), <span class="dt">linetype=</span><span class="st">'dotted'</span>, <span class="dt">color=</span><span class="st">'red'</span>, <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">"%Y"</span>), <span class="dt">date_breaks=</span><span class="st">"1 year"</span>,</a>
<a class="sourceLine" id="cb8-6" title="6">               <span class="dt">expand=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">.9</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Year"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"No. of deaths"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">"Figure 3. 2010 - 2014 estimates fitted to 2014/2015 season"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb8-13" title="13"></a>
<a class="sourceLine" id="cb8-14" title="14">g_mod_<span class="dv">1</span></a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>Gray - observed deaths<br>
Blue dash - fitted curved for 2011 / 2012, applied to 2012 / 2013 Red dotted - upper 90% prediction interval</p>
</div>
</div>
<div id="in-quantitative-terms" class="section level3">
<h3 class="hasAnchor">
<a href="#in-quantitative-terms" class="anchor"></a>In quantitative terms:</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">df_rpt &lt;-<span class="st"> </span>df_mod_<span class="dv">1</span>_sec <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(fluyr<span class="op">==</span><span class="dv">2014</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">select</span>(fluyr, week, fludeaths, pred_yhat_<span class="dv">0</span>, pred_yhat_upr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">excess_deaths =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(fludeaths <span class="op">-</span><span class="st"> </span>pred_yhat_upr, <span class="dv">0</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(., <span class="dv">0</span>) </a>
<a class="sourceLine" id="cb9-7" title="7"></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(df_rpt)</a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt; Source: local data frame [6 x 6]</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; Groups: &lt;by row&gt;</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt; # A tibble: 6 x 6</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt;   fluyr  week fludeaths pred_yhat_0 pred_yhat_upr excess_deaths</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="co">#&gt; 1  2014    23       702         686           852             0</span></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co">#&gt; 2  2014    24       600         666           833             0</span></a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt; 3  2014    25       665         647           814             0</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; 4  2014    26       625         630           797             0</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; # ... with 2 more rows</span></a></code></pre></div>
<p>Most weeks no excess deaths are reported, until the month of January when an epidemic occurs.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">total &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/formatc">formatC</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(df_rpt<span class="op">$</span>fludeaths), <span class="dt">format =</span> <span class="st">'d'</span>, <span class="dt">big.mark =</span> <span class="st">','</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">total_excess &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/formatc">formatC</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(df_rpt<span class="op">$</span>excess_deaths), <span class="dt">format =</span> <span class="st">'d'</span>, <span class="dt">big.mark =</span> <span class="st">','</span>)</a></code></pre></div>
<p>The total reported deaths for the 2014 - 2015 influenza season were 40,493 but only 902 are deemed in excess of expected based the 90% upper prediction interval for the cyclical regression.</p>
</div>
</div>
<div id="example--fitted-line-one-fourier-term" class="section level2">
<h2 class="hasAnchor">
<a href="#example--fitted-line-one-fourier-term" class="anchor"></a>Example. Fitted line (one Fourier term)</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">## Add fourier term</span></a>
<a class="sourceLine" id="cb11-2" title="2">fit &lt;-<span class="st"> </span>fludta <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(year<span class="op">&gt;=</span><span class="dv">2010</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week2 =</span> <span class="kw">row_number</span>(),</a>
<a class="sourceLine" id="cb11-5" title="5">         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>week2<span class="op">/</span><span class="dv">52</span>,</a>
<a class="sourceLine" id="cb11-6" title="6">         <span class="dt">sin_f1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sinpi</a></span>(theta),</a>
<a class="sourceLine" id="cb11-7" title="7">         <span class="dt">cos_f1 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cospi</a></span>(theta),</a>
<a class="sourceLine" id="cb11-8" title="8">         <span class="dt">pred_y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>( <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(perc_fludeaths <span class="op">~</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="st">                                </span>week2 <span class="op">+</span><span class="st"> </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, <span class="dt">data=</span>.)))</a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>A single Fourier term does a reasonable job approximating the secular trend of disease, except notably during severe influenza epidemics. The black solid line represents a single Fourier term.</p>
<p>During certain seasons, there is a pronounced spike above the predicted (fit) line. For example in the 12-13, 13-14 and 14-15 seasons. These can be subjectively considered severe influenza epidemics. However a goal could be to define objective criteria for epidemics. Such as any time-period 1.64 standard deviations above the fitted line representing a time of severe influenza morbidity and mortality, requiring significant public health intervention.</p>
<div id="note-regarding-standard-errors-" class="section level3">
<h3 class="hasAnchor">
<a href="#note-regarding-standard-errors-" class="anchor"></a>Note regarding standard errors.</h3>
<p>By default R’s predict.lm will fit a 95% prediction interval. In Serfling’s original paper it states:</p>
<blockquote>
<p>“The epidemic threshold…is placed at a distance of 1.64 standard deviations above the trend line, a level which experience has shown to be useful for distinguishing epidemic increase from random variation.”</p>
</blockquote>
<p>The CDC also describes the threshold as:</p>
<blockquote>
<p>“The seasonal baseline of P&amp;I deaths is calculated using a periodic regression model that incorporates a robust regression procedure applied to data from the previous five years. An increase of 1.645 standard deviations &gt; above the seasonal baseline of P&amp;I deaths is considered the ‘epidemic threshold,’ i.e., the point at which the observed proportion of deaths attributed to pneumonia or influenza was significantly higher than would be expected at that time of the year in the absence of substantial influenza-related mortality.”</p>
</blockquote>
<p><code>fluserf</code> follows this method, but the modified serfling function allows for more options for threshold prediction. 1.645 standard deviations is equivalents to a one-sided upper limit 95% confidence interval.</p>
</div>
</div>
<div id="fluserf-function" class="section level2">
<h2 class="hasAnchor">
<a href="#fluserf-function" class="anchor"></a>fluserf() function</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">##The following command completes the above steps </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">##fit serfling model</span></a>
<a class="sourceLine" id="cb12-3" title="3">flu_fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fluserf.html">fluserf</a></span>(<span class="dt">data=</span>df_cdc, <span class="dt">outc=</span>perc_fludeaths, <span class="dt">time=</span>yrweek_dt)</a>
<a class="sourceLine" id="cb12-4" title="4">flu_fit</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; # A tibble: 352 x 15</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">#&gt;    year  week fludeaths alldeaths perc_fludeaths yrweek_dt  fluyr</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;     &lt;int&gt;     &lt;int&gt;          &lt;dbl&gt; &lt;date&gt;     &lt;int&gt;</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt; 1  2010     1       960     13423           7.15 2010-01-03  2009</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">#&gt; 2  2010     2      1026     13019           7.88 2010-01-10  2009</span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">#&gt; 3  2010     3       988     12046           8.20 2010-01-17  2009</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt; 4  2010     4      1002     12466           8.04 2010-01-24  2009</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">#&gt; # ... with 348 more rows, and 8 more variables: prop_flupos &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">#&gt; #   week_in_order &lt;int&gt;, epi &lt;lgl&gt;, t &lt;int&gt;, sin_2 &lt;dbl&gt;, cos_2 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt; #   y0 &lt;dbl&gt;, y0_ul &lt;dbl&gt;</span></a></code></pre></div>
<div id="plot-function-fluplot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-function-fluplot" class="anchor"></a>Plot function fluplot</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/fluplot.html">fluplot</a></span>(flu_fit, <span class="dt">xvar=</span>yrweek_dt, perc_fludeaths, y0, y0_ul,</a>
<a class="sourceLine" id="cb13-2" title="2">                    <span class="dt">ylab=</span><span class="st">"% Deaths from P&amp;I"</span>, <span class="dt">title=</span><span class="st">"Serfling Model"</span>)</a></code></pre></div>
<p><img src="04-serfling_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
</div>
<div id="criticisms-of-this-approach" class="section level2">
<h2 class="hasAnchor">
<a href="#criticisms-of-this-approach" class="anchor"></a>Criticisms of this approach</h2>
<p>The historical Serfling model should be considered as important background and an useful educational tool. But probably not applied in an research project.</p>
<ul>
<li><p>The authors view the approach as a pragmatic one in the context of the 1960s when computation was difficult, but its implementation is now somewhat dated given modern computing methods. The constrains of needing an easy to estimate linear model are no longer relevant to the modern analyst. The use of a Fourier term to obtain fitted estimates and coefficients for “off-season” timepoints, then construct fitted lines for “on-season” timepoints makes many untested assumptions about the functional form and fixed parameters of seasonal influenza trend lines.</p></li>
<li><p>More elegant models (e.g. ARIMA, splines) are now available which may overcame the above limitations, and make fewer assumptions about the functional form.</p></li>
<li><p>Additionally the approach is dependent on an accurate baseline period. Whether to include mild or known epidemic seasons, which cut-off to define as the influenza season (e.g. week 40 - week 20) are important but subjective decisions the analyst must make.</p></li>
<li><p>The selected threshold for what constitutes “excess” is somewhat arbitrary. The original Serfling paper describes 1.64 standard deviations for 2 or more weeks as criteria. Recent papers have used the 95% prediction interval.</p></li>
</ul>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">sessioninfo<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/sessioninfo/topics/session_info">session_info</a></span>()</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#&gt; - Session info ----------------------------------------------------------</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">#&gt;  setting  value                       </span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#&gt;  version  R version 3.6.0 (2019-04-26)</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">#&gt;  os       Windows 10 x64              </span></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co">#&gt;  system   x86_64, mingw32             </span></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="co">#&gt;  ui       RTerm                       </span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt;  language (EN)                        </span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="co">#&gt;  collate  English_United States.1252  </span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">#&gt;  ctype    English_United States.1252  </span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">#&gt;  tz       America/New_York            </span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">#&gt;  date     2019-06-06                  </span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co">#&gt; - Packages --------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt;  package     * version    date       lib source        </span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt;  assertthat    0.2.1      2019-03-21 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt;  backports     1.1.4      2019-04-10 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">#&gt;  broom         0.5.2      2019-04-07 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="co">#&gt;  cellranger    1.1.0      2016-07-27 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="co">#&gt;  cli           1.1.0      2019-03-19 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="co">#&gt;  colorspace    1.4-1      2019-03-18 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-22" title="22"><span class="co">#&gt;  commonmark    1.7        2018-12-01 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-23" title="23"><span class="co">#&gt;  crayon        1.3.4      2017-09-16 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="co">#&gt;  curl          3.3        2019-01-10 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-25" title="25"><span class="co">#&gt;  desc          1.2.0      2018-05-01 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-26" title="26"><span class="co">#&gt;  digest        0.6.18     2018-10-10 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-27" title="27"><span class="co">#&gt;  dplyr       * 0.8.1      2019-05-14 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-28" title="28"><span class="co">#&gt;  evaluate      0.13       2019-02-12 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-29" title="29"><span class="co">#&gt;  fansi         0.4.0      2018-10-05 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-30" title="30"><span class="co">#&gt;  flumodelr   * 0.1.0.9999 2019-05-20 [1] local         </span></a>
<a class="sourceLine" id="cb14-31" title="31"><span class="co">#&gt;  forcats     * 0.4.0      2019-02-17 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-32" title="32"><span class="co">#&gt;  forecast    * 8.7        2019-04-29 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-33" title="33"><span class="co">#&gt;  fracdiff      1.4-2      2012-12-02 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-34" title="34"><span class="co">#&gt;  fs            1.3.1      2019-05-06 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-35" title="35"><span class="co">#&gt;  generics      0.0.2      2018-11-29 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-36" title="36"><span class="co">#&gt;  ggplot2     * 3.1.1      2019-04-07 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-37" title="37"><span class="co">#&gt;  glue          1.3.1      2019-03-12 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-38" title="38"><span class="co">#&gt;  gtable        0.3.0      2019-03-25 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-39" title="39"><span class="co">#&gt;  haven         2.1.0      2019-02-19 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-40" title="40"><span class="co">#&gt;  hms           0.4.2      2018-03-10 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-41" title="41"><span class="co">#&gt;  htmltools     0.3.6      2017-04-28 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-42" title="42"><span class="co">#&gt;  httr          1.4.0      2018-12-11 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-43" title="43"><span class="co">#&gt;  jsonlite      1.6        2018-12-07 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-44" title="44"><span class="co">#&gt;  knitr         1.22       2019-03-08 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-45" title="45"><span class="co">#&gt;  labeling      0.3        2014-08-23 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-46" title="46"><span class="co">#&gt;  lattice       0.20-38    2018-11-04 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-47" title="47"><span class="co">#&gt;  lazyeval      0.2.2      2019-03-15 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-48" title="48"><span class="co">#&gt;  lmtest        0.9-37     2019-04-30 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-49" title="49"><span class="co">#&gt;  lubridate   * 1.7.4      2018-04-11 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-50" title="50"><span class="co">#&gt;  magrittr      1.5        2014-11-22 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-51" title="51"><span class="co">#&gt;  MASS          7.3-51.4   2019-03-31 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-52" title="52"><span class="co">#&gt;  Matrix        1.2-17     2019-03-22 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-53" title="53"><span class="co">#&gt;  memoise       1.1.0      2017-04-21 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-54" title="54"><span class="co">#&gt;  mgcv          1.8-28     2019-03-21 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-55" title="55"><span class="co">#&gt;  modelr        0.1.4      2019-02-18 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-56" title="56"><span class="co">#&gt;  munsell       0.5.0      2018-06-12 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-57" title="57"><span class="co">#&gt;  nlme          3.1-139    2019-04-09 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-58" title="58"><span class="co">#&gt;  nnet          7.3-12     2016-02-02 [2] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-59" title="59"><span class="co">#&gt;  pillar        1.4.0      2019-05-11 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-60" title="60"><span class="co">#&gt;  pkgconfig     2.0.2      2018-08-16 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-61" title="61"><span class="co">#&gt;  pkgdown       1.3.0      2018-12-07 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-62" title="62"><span class="co">#&gt;  plyr          1.8.4      2016-06-08 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-63" title="63"><span class="co">#&gt;  purrr       * 0.3.2      2019-03-15 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-64" title="64"><span class="co">#&gt;  quadprog      1.5-7      2019-05-06 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-65" title="65"><span class="co">#&gt;  quantmod      0.4-14     2019-03-24 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-66" title="66"><span class="co">#&gt;  R6            2.4.0      2019-02-14 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-67" title="67"><span class="co">#&gt;  Rcpp          1.0.1      2019-03-17 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-68" title="68"><span class="co">#&gt;  readr       * 1.3.1      2018-12-21 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-69" title="69"><span class="co">#&gt;  readxl        1.3.1      2019-03-13 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-70" title="70"><span class="co">#&gt;  rlang         0.3.4      2019-04-07 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-71" title="71"><span class="co">#&gt;  rmarkdown     1.12       2019-03-14 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-72" title="72"><span class="co">#&gt;  roxygen2      6.1.1      2018-11-07 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-73" title="73"><span class="co">#&gt;  rprojroot     1.3-2      2018-01-03 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-74" title="74"><span class="co">#&gt;  rstudioapi    0.10       2019-03-19 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-75" title="75"><span class="co">#&gt;  rvest         0.3.4      2019-05-15 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-76" title="76"><span class="co">#&gt;  scales      * 1.0.0      2018-08-09 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-77" title="77"><span class="co">#&gt;  sessioninfo   1.1.1      2018-11-05 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-78" title="78"><span class="co">#&gt;  stringi       1.4.3      2019-03-12 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-79" title="79"><span class="co">#&gt;  stringr     * 1.4.0      2019-02-10 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-80" title="80"><span class="co">#&gt;  tibble      * 2.1.1      2019-03-16 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-81" title="81"><span class="co">#&gt;  tidyr       * 0.8.3      2019-03-01 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-82" title="82"><span class="co">#&gt;  tidyselect    0.2.5      2018-10-11 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-83" title="83"><span class="co">#&gt;  tidyverse   * 1.2.1      2017-11-14 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-84" title="84"><span class="co">#&gt;  timeDate      3043.102   2018-02-21 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-85" title="85"><span class="co">#&gt;  tseries       0.10-46    2018-11-19 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-86" title="86"><span class="co">#&gt;  TTR           0.23-4     2018-09-20 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-87" title="87"><span class="co">#&gt;  urca          1.3-0      2016-09-06 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-88" title="88"><span class="co">#&gt;  utf8          1.1.4      2018-05-24 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-89" title="89"><span class="co">#&gt;  vctrs         0.1.0      2018-11-29 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-90" title="90"><span class="co">#&gt;  withr         2.1.2      2018-03-15 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-91" title="91"><span class="co">#&gt;  xfun          0.7        2019-05-14 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-92" title="92"><span class="co">#&gt;  xml2          1.2.0      2018-01-24 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-93" title="93"><span class="co">#&gt;  xts           0.11-2     2018-11-05 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-94" title="94"><span class="co">#&gt;  yaml          2.2.0      2018-07-25 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-95" title="95"><span class="co">#&gt;  zeallot       0.1.0      2018-01-28 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-96" title="96"><span class="co">#&gt;  zoo           1.8-5      2019-03-21 [1] CRAN (R 3.6.0)</span></a>
<a class="sourceLine" id="cb14-97" title="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb14-98" title="98"><span class="co">#&gt; [1] C:/Users/User/Documents/R/win-library/3.6</span></a>
<a class="sourceLine" id="cb14-99" title="99"><span class="co">#&gt; [2] C:/Program Files/R/R-3.6.0/library</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#influenza">Influenza</a></li>
      <li><a href="#linear-and-cyclical-regression-models">Linear and Cyclical Regression Models</a></li>
      <li><a href="#example--fitted-line-one-fourier-term">Example. Fitted line (one Fourier term)</a></li>
      <li><a href="#fluserf-function">fluserf() function</a></li>
      <li><a href="#criticisms-of-this-approach">Criticisms of this approach</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kevin W. McConeghy, Rob Van Aalst, Andrew Zullo, Nina Joyce.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
