<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kevin W. McConeghy" />

<meta name="date" content="2017-12-13" />

<title>Serfling Model Background</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Serfling Model Background</h1>
<h4 class="author"><em>Kevin W. McConeghy</em></h4>
<h4 class="date"><em>2017-12-13</em></h4>



<p>The primary method paper was a 1963 paper published by Robert Serfling working for the Centers for Disease Control and Prevention.</p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1915276/">Serfling RE. Methods for current statistical analysis of excess pneumonia-influenza deaths. Public Health Rep. 1963 Jun; 78(6): 494 - 506.</a></p>
<p>The paper outlines a strategy for estimating what proportion of deaths are due to influenza. The underlying issue is that many deaths reported due to influenza and pneumonia may be due to other causes, while many deaths attritable other causes may be due to influenza. The primary goal was to develop a “standard curve of expected seasonal mortality”. The concept was that an individual could use historical data to estimate seasonal trends in influenza. Then for a given place-time an researcher could evaluate how many deaths occurred in excess of this baseline rate. Much of the original paper is of little interest given modern computing methods, but the basic concept persists as a reasonable approach to estimating “flu” deaths.</p>
<div id="influenza" class="section level2">
<h2>Influenza</h2>
<p>Critically, it should be understood that influenza epidemics are highly seasonal with spikes in the winter months, commonly January - February. This seasonality leads to a cyclical rate of influenza morbidity and mortality.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flu_ex &lt;-<span class="st"> </span>flumodelr<span class="op">::</span>flu_ex

g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(flu_ex, <span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;#CC0000&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%Y&quot;</span>), <span class="dt">date_breaks=</span><span class="st">&quot;1 year&quot;</span>,
               <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year-month&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Deaths per 100,000&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>)
g1</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It was noted by early researchers that the rate of reported deaths (red line), could be modeled by a mathematical function.</p>
</div>
<div id="linear-and-cyclical-regression-models" class="section level2">
<h2>Linear and Cyclical Regression Models</h2>
<p>The classical ordinary least squares framework is often described in matrix notation as:<br />
<span class="math display">\[y_i = X_i\beta + u_{i} \quad \textrm{where} \quad i = 1,..,n\]</span></p>
<p>Where <span class="math inline">\(y\)</span> is a dependent variable, <span class="math inline">\(X\)</span> is a vector of regressors (i.e. independent variables) with <span class="math inline">\(k\)</span>-dimensions, <span class="math inline">\(\beta\)</span> is a vector of the coefficients for <span class="math inline">\(X\)</span>, and <span class="math inline">\(u\)</span> is the residual error term. often simply as: <span class="math inline">\(y= X\beta+u\)</span>.</p>
<p>Given a simple additive model with one independent variable x: <span class="math display">\[Eq \ 1. \  y = \alpha_0 + \beta_1*x_1 + u\]</span></p>
<p>Assume x, is a unit of time. The above model is inadequate, and will poorly fit the data (figure) because the secular trend is non-linear.</p>
<p>Early investigators such as Serfling proposed that a Fourier term be added to model the cycle like so: <span class="math display">\[Eq \ 2. \  y = \alpha_0 + \beta_1*t + sine(\frac{2 \pi t}{52}) + cos(\frac{2 \pi t}{52}) + u\]</span> Where t, is some unit of time (i.e. week, month). The original paper used 4-week periods so the period denominator is 13. The waveform will be approximately sawtooth if the unit of time resets (0-52). If the unit of time is continuous it will be a smooth curve. This allows us to use a linear model which accounts for the cyclical nature of the disease. The original paper recommends one <a href="https://en.wikipedia.org/wiki/Fourier_series">Fourier term</a>.</p>
</div>
<div id="example.-fitted-line-one-fourier-term" class="section level2">
<h2>Example. Fitted line (one Fourier term)</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add fourier term
fit &lt;-<span class="st"> </span>flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week2 =</span> <span class="kw">row_number</span>(),
         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>week2<span class="op">/</span><span class="dv">52</span>,
         <span class="dt">sin_f1 =</span> <span class="kw">sinpi</span>(theta),
         <span class="dt">cos_f1 =</span> <span class="kw">cospi</span>(theta),
         <span class="dt">week_2 =</span> week2<span class="op">^</span><span class="dv">2</span>,
         <span class="dt">week_3 =</span> week2<span class="op">^</span><span class="dv">3</span>,
         <span class="dt">week_4 =</span> week2<span class="op">^</span><span class="dv">4</span>,
         <span class="dt">week_5 =</span> week2<span class="op">^</span><span class="dv">5</span>,
         <span class="dt">pred_y =</span> <span class="kw">predict</span>( <span class="kw">lm</span>(fludeaths <span class="op">~</span><span class="st"> </span>
<span class="st">                                </span>week2 <span class="op">+</span><span class="st"> </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, <span class="dt">data=</span>.)),
         <span class="dt">pred_ypoly =</span> <span class="kw">predict</span>( <span class="kw">lm</span>(fludeaths <span class="op">~</span><span class="st"> </span>week2 <span class="op">+</span><span class="st"> </span>
<span class="st">                                </span>week_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">5</span> <span class="op">+</span>
<span class="st">                                </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, <span class="dt">data=</span>.)))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A single Fourier term does a reasonable job approximating the secular trend of diseas, except notably during severe influenza epidemics. The black solid line represents a single Fourier term, while the blue dashed line includes a series of polynomial terms to smooth the line.</p>
<p>During certain seasons, there is a pronounced spike above the predicted (fit) line. For example in the 12-13, 13-14 and 14-15 seasons. These can be subjectively considered severe influenza epidemics. However a goal could be to define objective criteria for epidemics. Such as any time-period 1.64 standard deviations above the fitted line representing a time of severe influenza morbidity and mortality, requiring significant public health intervention.</p>
</div>
<div id="estimation-approach-for-attributable-or-excess-mortality" class="section level2">
<h2>Estimation approach for attributable or “excess” mortality</h2>
<p>The serfling paper describes 4 steps:</p>
<ul>
<li>Estimate secular trend<br />
</li>
<li>Remove trend from data<br />
</li>
<li>Estimate seasonal change from adjusted data<br />
</li>
<li>Restore trend component</li>
</ul>
<p>In this package we operationalize this like so:</p>
<ul>
<li>Construct a time-series dataset, with a variable for a flu outcome (i.e. deaths, hospitalizations).<br />
</li>
<li>Estimate a cyclical regression as above;</li>
<li>Fit a trend line (solid black line)<br />
</li>
<li>predict epidemic threshold (dashed black line)<br />
</li>
<li>Observations falling outside the dashed black line are “excess”<br />
</li>
<li>Quantify values in excess of threshold</li>
</ul>
</div>
<div id="step-wise-example" class="section level2">
<h2>Step-wise example</h2>
<p>The flumodelr function serflm will perform the above steps. We present the individual steps here for demonstration.</p>
<p>It is assumed the influenza epidemic period begins Oct. 1st, and ends May 31st. This is a conventional “flu” season in the U.S. However individual areas / regions may justify tailored periods. These assumptions are modifiable as options in the regression function.</p>
<div id="step-1.-formatted-influenza-data" class="section level3">
<h3>Step 1. Formatted Influenza data</h3>
<p>To compute a traditional Serfling model. The input dataframe must have time vector, indicator for the epidemic period (Oct. - May), and measure of influenza morbidity / mortality to be modeled.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Example data&quot;</span>)
<span class="co">#&gt; Example data</span>
flu_ex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(yrweek_dt, fludeaths)
<span class="co">#&gt; # A tibble: 259 x 2</span>
<span class="co">#&gt;    yrweek_dt fludeaths</span>
<span class="co">#&gt;       &lt;date&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2010-10-18  6.482143</span>
<span class="co">#&gt; 2 2010-10-25  6.605505</span>
<span class="co">#&gt; 3 2010-11-01  6.779817</span>
<span class="co">#&gt; 4 2010-11-08  6.581818</span>
<span class="co">#&gt; # ... with 255 more rows</span></code></pre></div>
<p><code>serflm()</code> Will allow you to specify the boundaries for epidemic periods, and then compute the baseline off of non-epidemic timepoints. Additionally you can provide it with a logical variable in the dataset which indicates the epidemic period.</p>
</div>
<div id="example-adding-epidemic-period-indicator" class="section level3">
<h3>Example adding epidemic period indicator</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flu_ex &lt;-<span class="st"> </span>flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">epi =</span> <span class="kw">if_else</span>(<span class="kw">month</span>(yrweek_dt)<span class="op">&gt;=</span><span class="dv">10</span> <span class="op">|</span><span class="st"> </span><span class="kw">month</span>(yrweek_dt)<span class="op">&lt;=</span><span class="dv">5</span>, T, F))  

flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(year<span class="op">&gt;=</span><span class="dv">2014</span>)
<span class="co">#&gt; # A tibble: 93 x 6</span>
<span class="co">#&gt;    year  week fludeaths  yrweek_dt prop_flupos   epi</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;date&gt;       &lt;dbl&gt; &lt;lgl&gt;</span>
<span class="co">#&gt; 1  2014     1  6.333333 2014-01-06   0.2806884  TRUE</span>
<span class="co">#&gt; 2  2014     2  8.933333 2014-01-13   0.3110651  TRUE</span>
<span class="co">#&gt; 3  2014     3  9.829060 2014-01-20   0.2910588  TRUE</span>
<span class="co">#&gt; 4  2014     4  9.058333 2014-01-27   0.2754467  TRUE</span>
<span class="co">#&gt; # ... with 89 more rows</span></code></pre></div>
<p>We see that there is now an indicator for Oct - May.</p>
</div>
<div id="step-2.-fit-predicted-outcome-and-epidemic-threshold" class="section level3">
<h3>Step 2. Fit predicted outcome and epidemic threshold</h3>
<p>Here we estimate a model using only non-epidemic period timepoints. The coefficients from this model will then be used to predict values during the epidemic period.</p>
<div id="step-2a.-compute-fourier-terms" class="section level4">
<h4>Step 2a. Compute fourier terms</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Compute fourier terms
flu_ex_serfling &lt;-<span class="st"> </span>flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week2 =</span> <span class="kw">row_number</span>(),
         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>week2<span class="op">/</span><span class="dv">52</span>,
         <span class="dt">sin_f1 =</span> <span class="kw">sinpi</span>(theta),
         <span class="dt">cos_f1 =</span> <span class="kw">cospi</span>(theta),
         <span class="dt">week_2 =</span> week2<span class="op">^</span><span class="dv">2</span>,
         <span class="dt">week_3 =</span> week2<span class="op">^</span><span class="dv">3</span>,
         <span class="dt">week_4 =</span> week2<span class="op">^</span><span class="dv">4</span>,
         <span class="dt">week_5 =</span> week2<span class="op">^</span><span class="dv">5</span>)</code></pre></div>
</div>
<div id="step-2b.-baseline-cyclical-model" class="section level4">
<h4>Step 2b. Baseline Cyclical model</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">base_fit &lt;-<span class="st"> </span>flu_ex_serfling <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fludeaths =</span> <span class="kw">if_else</span>(epi <span class="op">==</span><span class="st"> </span>T, <span class="ot">NA_real_</span>, fludeaths)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lm</span>(fludeaths <span class="op">~</span><span class="st"> </span>week2 <span class="op">+</span><span class="st"> </span>week_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, 
     <span class="dt">data=</span>., <span class="dt">na.action =</span> na.exclude)</code></pre></div>
<p>Fit a model using only non-epidemic periods.</p>
</div>
</div>
<div id="note-regarding-standard-errors." class="section level3">
<h3>Note regarding standard errors.</h3>
<p>By default R’s predict.lm will fit a 95% prediction interval. In Serfling’s original paper it states:</p>
<blockquote>
<p>“The epidemic threshold…is placed at a distance of 1.64 standard deviations above the trend line, a level which experience has shown to be useful for distinguishing epidemic increase from random variation.”</p>
</blockquote>
<p><code>serflm</code> allows the user to specify which threshold is desired.</p>
<div id="step-2c.-add-predicted-values-to-original-dataset." class="section level4">
<h4>Step 2c. Add predicted values to original dataset.</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Fitted values + prediction interval
df_pred &lt;-<span class="st"> </span>flu_ex_serfling <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">predict</span>(base_fit, <span class="dt">newdata=</span>., <span class="dt">se.fit=</span><span class="ot">TRUE</span>, 
          <span class="dt">interval=</span><span class="st">&quot;prediction&quot;</span>, <span class="dt">level=</span><span class="fl">0.95</span>)

pred_y0 &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">1</span>] <span class="co">#fitted values</span>
pred_y0_uci &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">3</span>] <span class="co">#95% UCI</span>
pred_y0_serf &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.64</span><span class="op">*</span><span class="kw">sd</span>(df_pred<span class="op">$</span>fit[,<span class="dv">1</span>]) 

df_base &lt;-<span class="st"> </span>flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_column</span>(., pred_y0, pred_y0_uci, pred_y0_serf)  

df_base <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, week, fludeaths, 
                   pred_y0, pred_y0_uci, pred_y0_serf)  
<span class="co">#&gt; # A tibble: 259 x 6</span>
<span class="co">#&gt;    year  week fludeaths  pred_y0 pred_y0_uci pred_y0_serf</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt; 1  2010    42  6.482143 8.197778    9.940941     9.783488</span>
<span class="co">#&gt; 2  2010    43  6.605505 8.252288    9.956168     9.837998</span>
<span class="co">#&gt; 3  2010    44  6.779817 8.309852    9.978698     9.895562</span>
<span class="co">#&gt; 4  2010    45  6.581818 8.368915   10.006804     9.954625</span>
<span class="co">#&gt; # ... with 255 more rows</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>Observed Deaths</strong> - No. of influenza / pneumonia deaths per 100,000 people.<br />
<strong>Predicted Deaths</strong> - A fit of the cyclical regression model, (one Fourier term).<br />
<strong>95% PI</strong> - upper 95% prediction interval.<br />
<strong>Serfling Threshold</strong> The fitted line + 1.64 standard deviations.</p>
</div>
</div>
<div id="step-3.-compute-excess-deaths" class="section level3">
<h3>Step 3. Compute excess deaths</h3>
<p>The next step is to compute the no. of deaths in excess of the epidemic threshold. In addition to being in excess, Serfling applies a rule that values are counted starting from two consecutive timepoints exceeding the threshold, then stopped after two timepoints below the threshold.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_epi &lt;-<span class="st"> </span>df_base <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">threshold =</span> <span class="kw">if_else</span>(fludeaths <span class="op">&gt;</span><span class="st"> </span>pred_y0_serf, T, F),
         <span class="dt">epidemic =</span> <span class="kw">if_else</span>(threshold<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span><span class="kw">lead</span>(threshold)<span class="op">==</span>T, T, <span class="ot">NA</span>),
         <span class="dt">epidemic2 =</span> <span class="kw">if_else</span>(<span class="kw">lag</span>(epidemic)<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span>threshold<span class="op">==</span>T, T, epidemic),
         <span class="dt">epidemic3 =</span> <span class="kw">if_else</span>(<span class="kw">lag</span>(epidemic2)<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span><span class="kw">lead</span>(threshold)<span class="op">==</span>T, T, epidemic2),
         <span class="dt">epidemic4 =</span> <span class="kw">if_else</span>(<span class="kw">lag</span>(epidemic3)<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span>threshold<span class="op">==</span>T, T, epidemic3),
         <span class="dt">epidemic5 =</span> <span class="kw">coalesce</span>(epidemic4, F)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">epidemic =</span> <span class="kw">if_else</span>(<span class="kw">sum</span>(epidemic, epidemic2, epidemic3, 
                                   epidemic4, epidemic5, <span class="dt">na.rm=</span>T)<span class="op">&gt;</span><span class="dv">0</span>, T, F),
         <span class="dt">excess =</span> <span class="kw">if_else</span>(epidemic<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span>(fludeaths <span class="op">-</span><span class="st"> </span>pred_y0_uci)<span class="op">&gt;</span><span class="dv">0</span>, fludeaths <span class="op">-</span><span class="st"> </span>pred_y0_uci, <span class="dv">0</span>))
df_epi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, week, threshold, epidemic, excess)
<span class="co">#&gt; Source: local data frame [259 x 5]</span>
<span class="co">#&gt; Groups: &lt;by row&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 259 x 5</span>
<span class="co">#&gt;    year  week threshold epidemic excess</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;     &lt;lgl&gt;    &lt;lgl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  2010    42     FALSE    FALSE      0</span>
<span class="co">#&gt; 2  2010    43     FALSE    FALSE      0</span>
<span class="co">#&gt; 3  2010    44     FALSE    FALSE      0</span>
<span class="co">#&gt; 4  2010    45     FALSE    FALSE      0</span>
<span class="co">#&gt; # ... with 255 more rows</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="serflm-function" class="section level2">
<h2>serflm() function</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##The following command completes the above steps 

##specify an epidemic period
flu_ex &lt;-<span class="st"> </span>flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">epi =</span> <span class="kw">if_else</span>(<span class="kw">month</span>(yrweek_dt)<span class="op">&gt;=</span><span class="dv">10</span> <span class="op">|</span><span class="st"> </span><span class="kw">month</span>(yrweek_dt)<span class="op">&lt;=</span><span class="dv">5</span>, T, F))  

##fit serfling model
flu_ex_pred &lt;-<span class="st"> </span><span class="kw">serflm</span>(<span class="dt">data=</span>flu_ex, 
                      <span class="dt">outc=</span><span class="st">&quot;fludeaths&quot;</span>, <span class="dt">epi=</span><span class="st">&quot;epi&quot;</span>, <span class="dt">time=</span><span class="st">&quot;yrweek_dt&quot;</span>)
<span class="co">#&gt; Cyclical Regression Model </span>
<span class="co">#&gt;  ============================================================ </span>
<span class="co">#&gt; Setting regression parameters...</span>
<span class="co">#&gt;  'epi' variable is: epi </span>
<span class="co">#&gt;  'time' variable is: yrweek_dt </span>
<span class="co">#&gt;   time interval is: 52 </span>
<span class="co">#&gt; Model Formula: </span>
<span class="co">#&gt; fludeaths ~ t_unit + sin_f1 + cos_f1</span>
<span class="co">#&gt; t_unit is:  yrweek_dt </span>
<span class="co">#&gt;  sin_f1 / cos_f1 is a Fourier term</span></code></pre></div>
</div>
<div id="criticisms-of-this-approach" class="section level2">
<h2>Criticisms of this approach</h2>
<p>The historical Serfling model should be considered as important background and an useful educational tool. But probably not applied in an research project.</p>
<ul>
<li><p>The authors view the approach as a pragmatic one in the context of the 1960s when computation was difficult, but its implementation is now somewhat dated given modern computing methods. The constrains of needing an easy to estimate linear model are no longer relevant to the modern analyst. The use of a Fourier term to obtain fitted estimates and coefficients for “off-season” timepoints, then construct fitted lines for “on-season” timepoints makes many untested assumptions about the functional form and fixed parameters of seasonal influenza trend lines.</p></li>
<li><p>More elegant models (e.g. ARIMA, splines) are now available which may overcame the above limitations, and make fewer assumptions about the functional form.</p></li>
<li><p>Additionally the approach is dependent on an accurate baseline period. Whether to include mild or known epidemic seasons, which cut-off to define as the influenza season (e.g. week 40 - week 20) are important but subjective decisions the analyst must make.</p></li>
<li><p>The selected threshold for what constitutes “excess” is somewhat arbitrary. The original Serfling paper describes 1.64 standard deviations for 2 or more weeks as criteria. Recent papers have used the 95% prediction interval.</p></li>
</ul>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
