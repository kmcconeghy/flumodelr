<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kevin W. McConeghy" />

<meta name="date" content="2017-12-06" />

<title>Serfling Model Background</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Serfling Model Background</h1>
<h4 class="author"><em>Kevin W. McConeghy</em></h4>
<h4 class="date"><em>2017-12-06</em></h4>



<p>The primary method paper was a 1963 paper published by Robert Serfling from the Centers for Disease Control and Prevention.</p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1915276/">Serfling RE. Methods for current statistical analysis of excess pneumonia-influenza deaths. Public Health Rep. 1963 Jun; 78(6): 494 - 506.</a></p>
<p>The paper outlines a strategy for estimating the proportion of deaths are due to influenza. The primary goal was to develop a “standard curve of expected seasonal mortality”. The concept was that an individual could use historical data to estimate seasonal trends in influenza. Then for a given place-time an researcher could evaluate how many deaths occurred in excess of this baseline rate. Much of the original paper is of little interest given modern computing methods, but the basic concept persists as a reasonable approach to estimating “flu” deaths.</p>
<div id="influenza" class="section level2">
<h2>Influenza</h2>
<p>Critically, it should be understood that influenza epidemics are highly seasonal with spikes in the winter months, commonly January - February. This seasonality leads to a cyclical rate of influenza morbidity and mortality.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flu_ex &lt;-<span class="st"> </span>flumodelr<span class="op">::</span>flu_ex

## Make Example Figure 
df &lt;-<span class="st"> </span>flu_ex <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(year<span class="op">&gt;=</span><span class="dv">2010</span>) <span class="co">#only most recent years</span>

g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt, <span class="dt">y=</span>fludeaths)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;#CC0000&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%Y&quot;</span>), <span class="dt">date_breaks=</span><span class="st">&quot;1 year&quot;</span>,
               <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year-month&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Deaths per 100,000&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>)
g1</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It was noted by early researchers that the cyclical rate (red line), could be modeled by a mathematical function.</p>
</div>
<div id="linear-and-cyclical-regression-models" class="section level2">
<h2>Linear and Cyclical Regression Models</h2>
<p>The classical ordinary least squares framework is often described in matrix notation as:<br />
<span class="math display">\[y_i = X_i\beta + u_{i} \quad \textrm{where} \quad i = 1,..,n\]</span></p>
<p>Where <span class="math inline">\(y\)</span> is a dependent variable, <span class="math inline">\(X\)</span> is a vector of regressors (i.e. independent variables) with <span class="math inline">\(k\)</span>-dimensions, <span class="math inline">\(\beta\)</span> is a vector of the coefficients for <span class="math inline">\(X\)</span>, and <span class="math inline">\(u\)</span> is the residual error term. often simply as: <span class="math inline">\(y= X\beta+u\)</span>.</p>
<p>Given a simple additive model with one independent variable x: <span class="math display">\[Eq \ 1. \  y = \alpha_0 + \beta_1*x_1 + u\]</span></p>
<p>Assume x, is the rate of influenza in a simple time-series. The above model is inadequate, and will poorly fit the data (figure) because the secular trend is cyclical around winter months.</p>
<p>Early investigators such as Serfling proposed that a Fourier term be added to model the cycle like so: <span class="math display">\[Eq \ 2. \  y = \alpha_0 + \beta_1*t + sine(\frac{2 \pi t}{52}) + cos(\frac{2 \pi t}{52}) + u\]</span> Where t, is unit of time (i.e. week). The waveform will be approximately sawtooth if the week counter resets (0-52). If the unit of time is continuous it will be a smooth curve. This allows us to estimate a linear model which accounts for the cyclical nature of the disease. The original paper recommends one <a href="https://en.wikipedia.org/wiki/Fourier_series">Fourier term</a>. However, this was a pragmatic decision, and modern approaches could easily incorporate more.</p>
</div>
<div id="example.-fitted-line-one-fourier-term" class="section level2">
<h2>Example. Fitted line (one Fourier term)</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add fourier term
fit &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week2 =</span> <span class="kw">row_number</span>(),
         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>week2<span class="op">/</span><span class="dv">52</span>,
         <span class="dt">sin_f1 =</span> <span class="kw">sinpi</span>(theta),
         <span class="dt">cos_f1 =</span> <span class="kw">cospi</span>(theta),
         <span class="dt">pred_y =</span> <span class="kw">predict</span>( <span class="kw">lm</span>(fludeaths <span class="op">~</span><span class="st"> </span>
<span class="st">                                </span>week2 <span class="op">+</span><span class="st"> </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, <span class="dt">data=</span>.)))

g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fit, <span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>fludeaths), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;#CC0000&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>pred_y), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%Y&quot;</span>), <span class="dt">date_breaks=</span><span class="st">&quot;1 year&quot;</span>,
               <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Deaths per 100,000&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>)
g1</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>You can add polynomial terms to smooth the line.</p>
</div>
<div id="example.-smoothed-line" class="section level2">
<h2>Example. Smoothed line</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add fourier term, polynomials
fit &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week2 =</span> <span class="kw">row_number</span>(),
         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>week2<span class="op">/</span><span class="dv">52</span>,
         <span class="dt">sin_f1 =</span> <span class="kw">sinpi</span>(theta),
         <span class="dt">cos_f1 =</span> <span class="kw">cospi</span>(theta),
         <span class="dt">week_2 =</span> week2<span class="op">^</span><span class="dv">2</span>,
         <span class="dt">week_3 =</span> week2<span class="op">^</span><span class="dv">3</span>,
         <span class="dt">week_4 =</span> week2<span class="op">^</span><span class="dv">4</span>,
         <span class="dt">pred_y =</span> <span class="kw">predict</span>( <span class="kw">lm</span>(fludeaths <span class="op">~</span><span class="st"> </span>
<span class="st">                                </span>week2 <span class="op">+</span><span class="st"> </span>week_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">4</span> <span class="op">+</span>
<span class="st">                                </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, <span class="dt">data=</span>.))) 

<span class="kw">ggplot</span>(fit, <span class="kw">aes</span>(<span class="dt">x=</span>yrweek_dt)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>fludeaths), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;#CC0000&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>pred_y), <span class="dt">size=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> <span class="kw">date_format</span>(<span class="st">&quot;%Y&quot;</span>), <span class="dt">date_breaks=</span><span class="st">&quot;1 year&quot;</span>,
               <span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">9</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Deaths per 100,000&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_light</span>(<span class="dt">base_size=</span><span class="dv">16</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be noted here that during certain seasons, there is a pronounced spike above the predicted (fit) line. For example in the 12-13, 13-14 and 14-15 seasons. These can be subjectively considered severe influenza epidemics.</p>
</div>
<div id="estimation-approach" class="section level2">
<h2>Estimation approach</h2>
<p>The serfling paper describes 4 steps:</p>
<ul>
<li>Estimate secular trend<br />
</li>
<li>Remove trend from data<br />
</li>
<li>Estimate seasonal change from adjusted data<br />
</li>
<li>Restore trend component</li>
</ul>
<p>In this package we operationalize this like so:</p>
<ul>
<li>Construct a time-series dataset, with a variable for a flu outcome (i.e. deaths, hospitalizations).<br />
</li>
<li>Estimate a cyclical regression as above;</li>
<li>Fit a trend line (solid black line)<br />
</li>
<li>predict epidemic threshold (dashed black line)<br />
</li>
<li>Observations falling outside the dashed black line are “excess”<br />
</li>
<li>Quantify values in excess of threshold</li>
</ul>
</div>
<div id="step-wise-example" class="section level2">
<h2>Step-wise example</h2>
<p>The flumodelr function serflm will perform the above steps. We present the individual steps here for demonstration.</p>
<p>It is assumed the influenza epidemic period begins Oct. 1st, and ends May 31st. This is a conventional “flu” season in the U.S. However individual areas / regions may justify tailored periods. These assumptions are modifiable as options in the regression function.</p>
<div id="step-1.-formatted-influenza-data" class="section level3">
<h3>Step 1. Formatted Influenza data</h3>
<p>The input dataframe must have time vector, indicator for the epidemic period, and measure of influenza morbidity / mortality to be modeled.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">flu_ex <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(yrweek_dt, epi, fludeaths)
<span class="co">#&gt; # A tibble: 2,847 x 3</span>
<span class="co">#&gt;    yrweek_dt   epi fludeaths</span>
<span class="co">#&gt;       &lt;date&gt; &lt;lgl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1962-01-08  TRUE  5.295082</span>
<span class="co">#&gt; 2 1962-01-15  TRUE  5.434426</span>
<span class="co">#&gt; 3 1962-01-22  TRUE  5.745902</span>
<span class="co">#&gt; 4 1962-01-29  TRUE  5.295082</span>
<span class="co">#&gt; # ... with 2,843 more rows</span></code></pre></div>
</div>
<div id="step-2.-fit-predicted-outcome-and-epidemic-threshold" class="section level3">
<h3>Step 2. Fit predicted outcome and epidemic threshold</h3>
<p>Here we run a model as above, but only for non-epidemic periods.</p>
<div id="step-2a.-compute-fourier-terms" class="section level4">
<h4>Step 2a. Compute fourier terms</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Compute fourier terms
df_mod &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">week2 =</span> <span class="kw">row_number</span>(),
         <span class="dt">theta =</span> <span class="dv">2</span><span class="op">*</span>week2<span class="op">/</span><span class="dv">52</span>,
         <span class="dt">sin_f1 =</span> <span class="kw">sinpi</span>(theta),
         <span class="dt">cos_f1 =</span> <span class="kw">cospi</span>(theta),
         <span class="dt">week_2 =</span> week2<span class="op">^</span><span class="dv">2</span>,
         <span class="dt">week_3 =</span> week2<span class="op">^</span><span class="dv">3</span>,
         <span class="dt">week_4 =</span> week2<span class="op">^</span><span class="dv">4</span>)</code></pre></div>
</div>
<div id="step-2b.-baseline-cyclical-model" class="section level4">
<h4>Step 2b. Baseline Cyclical model</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">base_fit &lt;-<span class="st"> </span>df_mod <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fludeaths =</span> <span class="kw">if_else</span>(epi <span class="op">==</span><span class="st"> </span>T, <span class="ot">NA_real_</span>, fludeaths)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">lm</span>(fludeaths <span class="op">~</span><span class="st"> </span>week2 <span class="op">+</span><span class="st"> </span>week_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>week_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>sin_f1 <span class="op">+</span><span class="st"> </span>cos_f1, 
     <span class="dt">data=</span>., <span class="dt">na.action =</span> na.exclude)</code></pre></div>
<p>Fit a model using only non-epidemic periods.</p>
</div>
</div>
<div id="note-regarding-standard-errors." class="section level3">
<h3>Note regarding standard errors.</h3>
<p>By default R’s predict.lm will fit a 95% prediction interval. In Serfling’s original paper it states:</p>
<blockquote>
<p>“The epidemic threshold…is placed at a distance of 1.64 standard deviations above the trend line, a level which experience has shown to be useful for distinguishing epidemic increase from random variation.”</p>
</blockquote>
<p>However recent papers have selected a 95% prediction interval (i.e. 1.96 standard deviations). <code>serflm</code> will allow the user to specify which threshold is desired.</p>
<div id="step-2c.-add-predicted-values-to-original-dataset." class="section level4">
<h4>Step 2c. Add predicted values to original dataset.</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Fitted values + prediction interval
df_pred &lt;-<span class="st"> </span>df_mod <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">predict</span>(base_fit, <span class="dt">newdata=</span>., <span class="dt">se.fit=</span><span class="ot">TRUE</span>, <span class="dt">interval=</span><span class="st">&quot;prediction&quot;</span>, <span class="dt">level=</span><span class="fl">0.95</span>)

pred_y0 &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">1</span>] <span class="co">#fitted values</span>
pred_y0_uci &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">3</span>] <span class="co">#95% UCI</span>
pred_y0_serf &lt;-<span class="st"> </span>df_pred<span class="op">$</span>fit[,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.64</span><span class="op">*</span><span class="kw">sd</span>(df_pred<span class="op">$</span>fit[,<span class="dv">1</span>]) <span class="co">#Fitted line + 1.64 SD</span>

df_base &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_column</span>(., pred_y0, pred_y0_uci, pred_y0_serf)
df_base <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, week, fludeaths, pred_y0, pred_y0_uci, pred_y0_serf)
<span class="co">#&gt; # A tibble: 351 x 6</span>
<span class="co">#&gt;    year  week fludeaths  pred_y0 pred_y0_uci pred_y0_serf</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt; 1  2010     1  8.648649 7.472088    8.697884     8.865895</span>
<span class="co">#&gt; 2  2010     2  9.243243 7.560870    8.791696     8.954678</span>
<span class="co">#&gt; 3  2010     3  8.981818 7.635828    8.868477     9.029635</span>
<span class="co">#&gt; 4  2010     4  8.867257 7.696219    8.927128     9.090026</span>
<span class="co">#&gt; # ... with 347 more rows</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAABU1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtNTU1NTW5NTY5Nbm5NbqtNjshmAABmADpmAGZmOgBmOjpmZgBmZjpmZmZmZpBmkGZmkJBmkLZmkNtmtpBmtrZmtttmtv9uTU1uTW5uTY5ubm5uq+SOTU2OTW6OyP+QOgCQOjqQOmaQZjqQZmaQkDqQkGaQkLaQtpCQtraQttuQ29uQ2/+rbk2r5P+zs7O2ZgC2Zjq2kDq2kGa2tma2tpC2tra2ttu227a229u22/+2/7a2/9u2///Ijk3I5KvI///MAADbkDrbkGbbtmbbtpDbtrbbttvb25Db27bb29vb2//b/9vb///e3t7kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////b3Z4KAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2d/3/ctnnHcbK96po4s9NI6SJ19pK0zmZ1Xdyoa5dtmV1f6jVt3ForVTtNnFjKWU7kM/7/n0Z8f/CVAHlfSOr5vBLrjgQfguT7HgAPAIJQFKrHIpvOAAqVEgKK6rUQUFSvhYCiei0EFNVrIaCoXgsBRfVaCCiq10JAUb0WAorqtboBer5/5Zmz6a9TQv55f+tRJ7u1zmo7TJPrn6cTPrlF6eJwcjfTHtOOvesYbDh2d/oKJoHmJ3cz8iMUS3gO7mBGlkasZQM6Z0/oX5YIaK03U+nmZBsBHbGWDegx2X5m3d62Optu87/fPZgmH1A+oJ6zD6kTDfp2IKBL0/IB3aFLBZQhmHraCOi4tQRA65v8P58ScvkTVdBts9srb73k4skNQi7dphQmPt/XRWK9/cHrrL5pGDKA0pl4QtoGTD3jJ2Qnqyu/l/nDfsz2venS6AA6IwePp2Ryi20TBCw+ZQaO3XPVCc9ukMkHdPE7eQKZ/IE63LkdVFylzs9s68+HZOuhlX+dRSvj9MXN+mLeeEgVoDBL4asav5YCqOYsBuixSMF9nU4MAVWbjd8AgIqPxgZMrQF9V6Eu07n+0gP0PZ2MEyBtXuU0gHOphLdn5gQm+bZ1Dgiozs9s65/4aYBNk0WYUG3WZRDMUuSqxq/lADq5TV8cynsvby8E9Gx6uW6K1ykO7MRM9QZ+/6/UjuPFfp1CCgDKzwJsWKllES+t7tSJJ5+odFAeoKyy/GQqTs7/ufyQHcY+w3PVCd/idNVmXxyC5LVTPJvaBTQAVOenNiBvhLYJsggT1r/u2kMuPhU/3hpQkKXYVY1fywGUeZ15HNCZeI4stZWYKj5VVQxUtyxAmauENkBqBaiyGqv/gmb2FV414CzNhW/jBNzV2QHnqhNu848cDX4yllxmwakeQkD1VQoD0CbIop1QGDuWVwGztIxa/TC1HEDZw1OFuQ+oKpFZmWwlpvrx1fruiwc3SRRQaMNKrQA9MCebXP/Ez6oHKPdFi0PuqXZ0hgR94FwCGwkIz9RxFBgIqL5KYcC5ByqLVsalOxZwbj1yshS8qvFrOY0kWNv0AdWVTeK2nVhhLR7pX6e6/iXkFPHQhpUatuJlfYLtecMN77tFvKCBH8jyrFz6nNNnAXpAfUDDMQG3FS8BFQaATZNF6y5J5hWgMEuxqxq/1gOocTc2oHPVKqrreJeu3fo8XMR7JTdM7QEqmvheNL4IUHCupQEKXa7OYjagkasav1YGqESAVfJkZYrLSqwjnCpFGNCZqSP6qX1A2Vme3CROGeyHmYSpQBEPzxUBtLGI9wF1Ap4ii1ZFSKZQtMIsxa5q/FohoPzB8DJcVjTBY5CFsXpo8lnIJoPcZAL17KkAG1bqIKCBvgIP0G1hWzaSpAXZSDLnigDqn1DfDkpDgFo2TRbthHYjycpS5KrGr9UBymNBj6eMgDkP1by44ZZpOmhSf7xNWQITWHS7OoENKzU/LbB6Nt1idbvfuSFDP8z0Fg8zHei40eQTupjJeq0+VwRQEWZ6cWgXuSlAgU2QRafyLMJMPBLF76DOUuyqxq/VASqq9ddgoN5OrOLS7IHM1EcAqN6tHAtogpvULN22DQQX21A/1kcBe8KpX+Uf36RW5H3yLgzUm+a+B6hsldu8pAAN5J93UPjdGU6gXmQJXNXF0uoApayH8Dbo6uQdgxFAWcchuXTrS0OUAurS9Ydyi7Zhp65b9Fe+gVlgnYKEH5UElHV1ip5H03dpdXWKc0UAFV2dTtdjElBg02TRrip4XZ0P7K5Oou/FxdG4Byyf/2Osyja7eH0yw9S4AT2OVtkQ0IFo1IAu/j1aZUNAB6JRA5oQAjoQXVRAUQMRAorqtRBQVK+FgKJ6LQQU1WshoKheCwFF9VoIKKrXQkBRvVYuoC9/+Vv2753d3R//RW+8jxqkVkLSipQL6NHbv2V87tWf3vlWbWy80pOO+1dvYABZXLqBEQJae04G6HP2z/f/+lu1GQEdpIERAvp8z2CJgA7dwAgBhVjKIp5XZk5QA9S4AT19WztQ9KDDNDBqQE93PzIbEdBBGhgzoEfAfyKgAzUwYkBPQRCUIqADNTBeQEEDnmscgFbVSs/QPwPjBfR0l0vXQscCaIrQzWcRAW0tBDQjQf8MIKBa/X94CGjP5QD61cfv1fpZ5ntSEdCMBP0zMFxAH+v3F01u5xyMgGYk6J+BwQI6J5NbT9mHpw+mWe81QEAzEvTPwFABXYBFTuZZL6JEQDMS9M/AUAGFr+/Ne5UvApqRoH8GhguoeT0qfLNmXAhoRoL+GRgqoGpxK8pL++1gclsIaEaC/hkYLKDsldOXWJjpauaikAhoRoJmA+m+VgQU6MlNEWV6I29RMwQ0I0EOoOsdDTBgQJm++zr7YAQ0IwEC2knY1YmA9lrY1YmA9lrY1YmA9lrY1YmA9lrdujo3PYF2Kar5uFgZGCqg2NW5kjOgB+0k7OpEQHst7OpEQHst7OrcOKAVApoQdnUioL0WdnUioL0WdnUioL0WdnUioL0WdnUioL0WdnUioL0WzurkgMQJQUA3K+zqrKokoQjoZoVdnQhor4VdnT0ANP2KUgRU6WJ2dSKgSnPdBlkcZj3/dQi7OhFQpQEAynTRujoRUKV5VmxxzcKuTgRUaUiALr747DPLk4rVjunR7q5ZSxYBzUkwREBZEV///+UNMvmAfX/xa0ImtzZS6kcAPd+f/PTGm2CDWCDp9J1vX93b0xsR0IwEwwVUtEd2WNCRf8oJ7CxdUQ/6h2cL40Llascv73xE6XOzVtJoAE0QcpEB3X5GjxmWM/LWM7r4dCM1gKLVjvk/nFKhkQBK6aYBTRK6MUBZX835/pVnZ9NtsXETLrRonSTuPCWgo1ntmM/53eTMY3butZ4/uw76THw6U4PcNhF7yh0PCgH9UG1ED5qRYLge1AM0p/t72codD+p5UCYENCPBGADdacrC6pQ7HhTroG0TDB/QxeHkg2fMfW24DpocD2rYXH4rXj6d0EMaBKAdByP1CFCpAxtQFWYyg93WqNzxoGKh46OVxEFlFDIUjBwIoJ2iRP0HlAfqyfWHTRlZhXLHg8qVuI92dw2fIwI0TkgeoF2G5PcG0F6qD+NBRwFoexeMgKbUh/GgCCgCGlUfxoMioAhoVJsdD2qReZEBTRGKgLbWEgDlD4cQ+cV7TAgoAmppza++0YASSoPPGQFFQIHW/uobCWhFFJ4IaKsclO0fLKDrf/VNRcTDqTSfCGibHJTtHyqgG3j1TaXKdgQUAQ1rs6++Ec+VEP6EyZAB7WAAAU2p26tv0sMk8gEl7AkLTssMIKAZCcYCaIuuzvQwiZJWvC7kywyMCND1DfgbLKDlXZ38tiZCqdmteCKL+Y0BGgVsfYB2+ImU7S8GVAy3i422O3vtUf1frq3zn9yNpq73edu6dXUKQLkNEuI0desIMYBWCGivAeVEzSO1vgI6qQOhc2gzoEwlXZ3grgb9aDagFVWlfL6BnP3rArRLHaEhA70BNISP2Zur7oAWqHMdlNjeY7CAJo4fEqDEk9guPei2GNMs/rAC/3yfzaMTRfzZa//BX/IgtjEtfvUxS3z2xo2tR3JrfdzfiSKe1RoO6q21GWufn6emq0+JAUo6zH9lBfsJX+1XzLploaa2llpnQp+7m4X2x3fPQKHKAZ3Kd4yc7x/Q+eQu83RzNub+gB5feSYBne6wSoDcxgE9ZGDunE0PqNzKDj+eMEDZJ1l3tfetANBUgobfNvE8qFuTbXYO4oBoLtbgQbuGAfrjQWMSHvTshxyfmk4Gk9ws2jzsv3qvRE6W1Iw8erwtd7CtNdTygLlgmPtSa5937m6Amh+ZbCk5CdK3jjeMKAixtCnig42zfAMIaIZkHZR5vSmRpTIRX8hEASpYk9vYURzQ+ZUvZYFebz3WgB4DQK193rmtQD107lmBeh7AFHY4KGUOkOhGktwwzDrohQG0Rqv2hpKiujiXTRwbUNPsUR5Uekl2TMyDmn3euSFRT6bk2ntK7+f0xRNZSNMWYSZ2hNMBj4C2y0Hh/paA1j6ORZpmE86prG9qOiVrchs7ik0Irb2uqmfKmieog/6QG7L3eee2sDqblr195z5nTFkKEBq9dSyxP8auHaC6Nl/8E+EJENBGiUbS1iPelfNWDZRpxU/u2h5UbmNaHL7HGlYcV7m1NvQj0IoX45Osfd657Yc6J0UvObEADREaB1T8cQHVNYZGA2a/aW8W/UR0AgR0ReJFfGc5z3RW9H4oF1APkIyuzg6A1uc7kVhGm0oI6LgALRO7UnBfCzyolDsIlAMKzaQBxTqolSD2K0VAoxYzATXH8ropsICNpBJAMw0MdjRTsQCg4apoFqBWdooD9Z0T9AbQXAcYSJAOBl9sQKl6PqEHFL635pz9AdSr/ZYaiA5oKgA0/DByAG3YbwsB1YoASqxWvLMrw4BJ7O0v68uiANAIoQUuuOQeAJl+3sgJGnMAv2REMhBQrWQclAYeqlvOlQNa6II1XyRSRq8DUPneitgJGnMAv2QE+wYN6Bf5o0FdQAM3uBzQ3DCTbE01PZuMp6s85yYBJfHzDzfMtBw5zzRvNqeSA6h/h2O3jnQHlGpAQV9WeaCrBlRXN8L7Gw0oF0y6FvGxEzTmoHD/RQY0s4QmsTqoqhA2GVBWTqw4VStAwVCqnApc1EBgTmqeAdBKCw5fLGjFh5tZYwKUzqc/KHy7ne1B7flJLQFtNqASLRFQdu52BiKlQa4B8cPWgBZ2x7EWpz4mHAgYE6DnN0vWxBFXWmlR3fEozbYGVH1PPBxuQwNqTm6rDNDQ/mYD8ZfzZRngPwwxLKyoniTE+VQ/kbwxZUMGdPGb5HC7V/cCqx1bgEpCZYLAvVVd5zx1+zqoPAcANExoUx3BABoJQ5Y1ksrrCIxMQvyRXfk50PmuFKENkYyWo5mC44jKZsy1UFGY6dW9ms4jQ6i80sr68Tf0JMG7yQ+Ck19KABX7lfcEPw/rkpo68y1AWznAE/nTEIAW+3CiqBJ0dgVUtR5TBtqNBz3fdwkFw41XpyJAzWpeQm0AVVIHOfOznAcUNADOAAENZaCgFd9mzLXKAlFvnmhhADTSlgLoCuKgkXnxmwL0i4/f/+ZvwcQrAFSNNYaAQgAb8hwC1FLz0wV+M+RCG5soJ/JH1rYOagNKdEszw4C8USoBqOskDUQBrTyJ7WZevJkiTLb5QOOz1/6XjTxWQ5iXLw9Q9hLbrT/tB4fWwyIerHZcifV65bzZzAnA4iCi5wvLD2xryRxitVSwuJ/5x+mzEjDTmZ+4aAIzO0JeRLsMmOnG4miRhcw8OOnUc2g6rCWgi8MDMEV4PpEj47eZa5UTkZfDpCUvzEQu/3F/69EsMrT+KNBIcjwoNNzgQa3xEaotbA1BLqmDtvCgDC1wVGjs88pb8TAOGxzTlB2oF1WEDh40Jg0omFQs37EkJxXLicgrkNuKP5zcZcH68Oykl3f2ai/qrdVZqVCoZZi3QOInFk1OcPplAFocoyEUAtqmjuB3dRaMBoBdnB0ANTlYJaAMSTmpWMw+VnVQORUp66XcxQr0JKn//cR8HdlAHdTE4Rw5twbefB0Tcfba3K4YUEpXAWi2C5bhJXXyDoCqzhIa+pUsr5GkJhqL2ccQUBp/uVg3LQFQ3QhvBhR85g14+wBtpBFQ09PUGlDdlwAP6kI4P39ZHJSPO/QAdW20AzTRVG0fZpJThMHsYzUdXkxELjWcIfduzNgrnbYezYMvsGVFvBsHBWGi5sKFn1H3DLoj3LSRFKD2DOMAoPaskeRoE21BqTugpXFQ82IBCahPaFMdIQhoykDLQD0rwcUUYTn7mE0aVh50ba34s+nk2nTy02n4bC/veI0kIkfxWBM8lWI9SVQ8CfcA1aGSCjPZnf3yoco2WgmgOsFSAS2eOOgDWjLmmuj+XmUhlIkxdXXWhN5gv5bLWb+G+5opqvpSLKuhyDdwoD4PhFiN4cCAZMcuAFR9s0+6SkCJ8l/yWL9a3ZgDEgBU7mkyYH6IPqBL7knapAIILb76/Ou8g++rdqgAw4yIlHeIxD0oLw19HiSh+ltTT1Ile3HIcgHN62sQ3apOI6msCkm8Oqi59gYDINThAOrWNMYGaL7u615kbgoM2VUtEO88ZuQNCfXrOS60savTdJWap1vY1ekCalcR8uNUug5MaS7hKUBzDBATgVUWQn58ZIA+effq1et5i3Xepzp2yf96rxIDgDqlfkWSgKodjYDKhpUVRsgDVGUxBGiWAWkEzFs2HjyX8K6AqiNNMzHgxkcFKGugTepG25tZq3zYNwK2y02cPRTslI2DEKAkAahftVVgckeqAW3yX9BJdgKU2JH+UBw1OSY2EAftCqjOF4jFOYcNGtAZufKQ0heHWW8Ru28fXXku9MQ7g6qdkioIKE0D6uYWlHEAULkvYADsSgCaX4klhLYHlKoavDq4O6A6I6MFVK02l/ciRudKYWizoaeyGdCsrk4Z6ldH2IA25UD8dQBtrMB5RtoC6h7UAlBtIQho1MCwARXdAW3X6jRvXOb/tgGUUBvQUKxKN9grACglgUccL2BDgNLmJrAxQAOAtuDLAGr+LWvnVZUXorf66MYEKOvBYn9aeVBuLwsPGl4VSewhDqBBA4JIagOqF/duzoHdWWoZzgRUGXEA9S4pF1D4jcDuiER3HDitfe7kPRg0oIvDyw/5vzn9qiFAM92P+5OH+wj1i3g3n5JhAyhPtBxAK3jCnI5GkKnlAKr8c7SWYvNJnYkzIwb0/OZVQi69njmzM3Cl6dqPOml8CiPVoRfhnsBG+zzC05kAoLS7BEDtUrYkkGoBmkO4OCj0DURTMwzoaHDQ6MgABXqjHFBaRQE1t68RUEGoa8A6jYqAii/qsWYA6oaRIoDGDTiyx+tVJlafIjzm7AyguV0FqjdNRTIcMyEDQwa0TGFAo1HIbECNC/Uejg70AwcKABVV20SIxbtiNSkTXEF7QGVOmksR4OpM6BIGnZq7OsE5dfTYm3tIQr/yckBZdNwd3zZjJWxozpxcl27yX7H5dPZB8ltsJdDlAwoItbrSq1wPquuWJPF6ReuFWxV4rLArJWTAlZ6UGS4eCwENtMJTrSzjc70hi3FACSj+uQkV+ajMWO8lF/GzbQapRWhqWW0BXXR3jwCF1s3wZAlgG0C1Rdj5Dkt1B9DwaBOoE9Od73gfuT/DAPzqEZquBavsisg66GxoBBTcZeJ0tC4bUAGPx9UAAA3OUgTzJMG0QzN9ks+EhPNA/cmKJDY1kZg0wmfI6Ywn1nZ94sTsSH2MmlmqJ5iWzs2004tvGfMyRRJ+DerUYliWmJgpDUTtqLvonkuZTeQhsZhs+K9xnnJ94zf4mMyfWcsc1yX7D9SyCRJQPiPZWe2YL6wkpirXR4hllmIrHXcHNLQRDkQ2bskMfNRlc9SDgj4hd86IVUsIGVBnb2yEq2NPCPDKck9TDZC7O51AldHKrp3RHA/qVH6siHukliLdpo7+gj3q6sq7OmOA8ilxjFG1vvEULjEnljnmK8URC1AxIxmudiwmJ6upymzyMq/GxlaZ05fTVmFAwVyjE02oM1a0GVCxL9oXHwPU1A9kDkLmRTYrVft07GtAgy0MZcCKU4E6gtdMagYU1oR0M88oHgYQV+DcBH0Ry+2Lrxnd1usb/xCsLye/8LU29y1AZSqz2rFaJdlaGFkduz4PqkLd1O4IKga0onFAFZ8JQENBRFB9081eUjm7mwG18iIrsYp1K1NBAwQe781B6gyovsGmN9c5tmWYia2tqdc39hbpZKsVL5wiXi8vq6Yry1WSxY65OEIeWwTok5vXH+ZkOQpo6LdbAKhxoRE8KsVnCFDriYUCXQZQ4o6AUnkjUfdjJWVpTypQj3EBDUTKiIGfiia4DSjpDiiBZbzfUCwGVMzXlC9uoBA9A2jAgwJATbNITl5u7UEXh2xKZ+YUvRigVei3q3toBJxJQHWNINEVVXmuxuwz34KTTgygbptdR3qyAa1AJVYD3pADYN6be115byGL98VXMgTq7SSgjHd+ALQFoGzdYr7asVnf2AM0UAc1HKrjxORkcER5HXRGrnxzSHbC045dRQCletgdvNOqclblAKowC49mUlWALEC9B2RX/lxASWOk3zMCq5BU3gBjNR2nCgHqzDUA798zzReR1h8Fq1OZnHX3oDwqTxiken1jD1BWjOuWuAuoWtFYteL1EepbeKVjc6Va7NU3Z1Px+pvmbMeuVI9cjgBaVVmAVjzk4paBVAY78wEVm0ECmR3Zde8crRrWyTCAxWdlb+8IKJgMI6vRzg/AOtj7iencVVWsobiyrs5YMd1FzrMXL22IvVnEVRxQHUjvCKhqyBB/n2Pe2m2++KNN9Ch8EgLUfbjJfpyqsoJq0noRoF4JXYFRWuJccQOx9WtMYy+Yg5UAuqp3iwQAPWbxhLbjQbkgoJXZWMnnlweocZPUJpToqckRAzBxdLCIqr0FanBwo++93es8cQElRYC618ChVxkAgAZqOlFAqb3dDSavxoMer+bdIn4d9I1pXdWdta+DMqlYqANopf1LI6CVaRH7Pq5KAwoDi/FAPagNO+atjSEwzCXVgLnDoVxAkwb8xZWUVzYutAWg9kWsB9AVyW/FE/Jm7UjbDlgWigNKDVnNgNJ2gOaEyfMBjWZRXmYEUOODwxmTmfBugmhjwm631KQ5cRdCe2xArSJo0IBS+l1dti+eZh2celWvjuVY2yBZqwc01k8oTxAD1GoYp0roSnadu9mTl+Z3FbjtvcCL7WW1OwdQ+D4Vb5cLKNg5cEALlHyXtG7Qmm36caT5EilUuNlvZ1fNgKqIfHw0k2Ij2MToAqipIze1ccBPDRpdBaBqM/934IB+95Tr64yDGwAlDqCkCNAqDCjs5IwZqIwLTc2KKgXUu1dhQCv9TgpThSShgj48nsAGlMbiCDQJqHURJ3ArHTig5zfkuIcuYSZVTrmAVmWAkgCgYHAu2xPmrwLPMGI/CSgseAFffos+UERT8FafCKC0EVAr+uQBCq+BRgDVFgLVnEEDOiOTW58x/aFDmEm204l2JZwE4gOaCPHJ4x2EVBBHPdYooJpQuN3qkokCarjTBaxbc9TpghXpygc0cnwUUApitLEhh6Y/zTuD3C2TjwlQ9WaRPDUASrUr0bhZgCZj0Pz4AKBVDqARFwo7zdWPJ1yDIzagzm6TKgIoSQEK+I4DSk28PzKiSxclFwzQ4uW4Q6qUCzVhJdIGUCuUrreUABpsQ8MgfaQGlwAUOsAwoBUoX+PTqmBlxbt00IBypsaaCEUmoMvoi9+cvCI+7UGD6yT5UkWPGm6pmkyFgFIHUBjoLwcUDp1Xs6ISFbhKpIs6wBSgsIc90cahlR3T14dTXSNyDQQK+CigxPprNGhAxZtFYjr60FtEISxZNqsBwcSpO+YAynNHXECl3SZA9YOELVjYumgCVE0c8cMAxEoTB9RvQ8vDQH7yAA229EyYLNbUVD+S7oCK4ZyNy3KeTfmIJzY6uf57LOYdqYPEZGQ5eqlAIPNsuLNRqKiPrNUZkLl3yl5VBqg0AwCtdEdUDqDqscgE7tQOUzeOlo+S0GYH2BpQGgOU/wsB9QklWYCGCV0RoGydmuNtSue8l/z8J3fZOOSZWt1LrrU0SUxWDgrk3awVH1sv/jko3plSgIp/pfdU44tpMaAEAErBM0kbMIQCQPVeEx1qBDQQWjJJ4oDSLoBKI6qlJoa0uvnQAYQUoCR8k1YEqFoncbYjv7H//v4Z2AtH5eeqqCfpdO/57q5cCREsJhtVZS31qrdkrXgqDfDHpD9XVd7CseklafkIJG4gaofIEHziHNxK1AIhsYnTaj6xnDccy4G5XJHYuRp9DfFbUcXykJjVSazfgvqkAV386mM2vVP+MZOQtxTANaCLX6m1PGsPqh3osgA9vynex8RmfviJj3b3LDfa9FME/k67TrODZr7VhagiDzqNJg8afwOu6gFIetBKD+tMTflIt1Hkh9iIZzkQKeoAdS0zNmekyYNWxR60GdBDNlR4R//Rk5CZ5KSP85+8zsfdsTqocaDecoq5sgB9+vSr/a3PWUfnk2kQUMbmyzsfNV6plMHJeQ75gKpIgLhxBqtGQOXjObE3VssDlOYCGm7iEEobASVRQFWQqRhQdtr2RTyftnm8Lf+AScgi2ZStP8cX8vxH6eYO5mqN2SU0kuxWUmjA8mntQIsB9T7SMkDh77oE0MoNk8vD1EyPJKC0CVCSA2i8ES63JQFV0drYzPwmQJ2GormNHQGdX/lG/PnSTEJWMmt1sz/zbfMGJ9Oc7+BBX3z2++nkv+M9nXwx2Ze/zGjFCy0HUFnOV7QQ0MoJk8vDdKiKJp+uijPGSmgdpkoCWqk2TmAvbQJUTkoJTkylOYBWsJpjfuYt3800F7M6bQ9KbeKsFy3VtVE2ZVPAuhRAWUs+1HpXenXvw9qNFtZBvY+0GNBKBZuWACjJBFRVAd2hQGZfGlA91iXUCCd5gFYRQFX9oBFQrxThavF2Oz7pfYfPP66rmvqPnoTMxFvw/KU2VNQ959t0yR60Ua/u5fUkSa0M0GYDMUCJZqsJUEmhHIzkth6aAa1gFdIDVCVqB6i+nmZAAwZaTjveYZXK99hf+QdMQuaai4rhsQyic9dp6qBLA/QpL+J//36X4XZS4NZ1BLSqAKA5BhSMPqBVa0CdXVUSUCqGF0bbOO5PLXgJVk8aPFpdz7oAlZLvttGvuFmDXEDl63E7jgdVMremO6Die64B7S69TRD1XEC9PXrUdLoGGAFUBySaADU1WetwCjKfvASRBZgDlnzQgLJZnZNrNzu8+gZqiYAGdqQMqApnAFBgoDWg+ldT7r8oaEA1AloFADV0NwPKs+C+RX/IgLLxoGxA03HeUohNCTYNqPVmw6oC/eaivJgAAAiGSURBVNMZgAL3E0SkCVAKAPWOzwbUWf6Z8kemTt0MKDNwApKw44Y8mkm8uOGg44sbtJYEqP8UcwGtbEB1F7sBNDWgirsf6kNQAKg4gUMY6AZqAhTOQ3BPngmodfwYAJ3X3rPbq2+0lgJoakczoARsIuWAVhag4g8YK5wBqOepCewGygCUOEfTiwwoG7DM3tB8FuzqdNVzQKmATG8CfOYDavFViWoCzQTUMqBS6j6xZkAhYTIVMQNrcwG1AGefBg3onGz9+ZD86LDbq2+UegGoM8cNGmgElNgQVFUFmvByVyr3pgcMAKryJ+NU6ZvgEApOngeo9bMcAaD08WuPzm4Q0u3VN0orBNQ9gX+kJEMSSogVsskCFHQ7VWATtfloMkBNmSzqwXBD6hqMEZ0D9TEfUDC2VWZg4IByffd11sFFgMLt+YBmn8A/VBfOqh+oKgaUhgCtCgCtPED1C79KAFUDTwhswecCSl03PgJAM1UAqK1cQBsTZAGqx+qFdqct6KFPEFCnhE0ZAO+okmAJf1YEaAUGmcGyIRfQSr/gYRyAfvHx+9/8LevgoQCqvE5odwOglQZU0EBMYLIRUEkXNS5PN+zLAKWGT8UlBLRp6qF249LYsAF9PCVk60/7OWHQIQHqepp8QEGpSkGRnQsoVS5TkWaAzwdU/9WeOw9QZQJUK+ocDBrQObn8x/2tR7Nl9yTZGhCgasUbVeKbozMB1YU8tcf6tQQUXlkBoGqKHxk4oGwRBRakX3pPkq1BAUp0kQyGyRUBSsynqhRQcwYDqNycD2hFzMSZYddBGZzq/+aDhwGoqfKFdjcCWmnvY95JVgSonBCgIqi0PaCwHl0GqGloDbyRVAhoeL5rs6rSFYXbnkI8xpPKO6XenbagHi37yP7Coys1qTplgifTbRw9gxpOxc66EGnNHCGvLOdWypTyd5KYdtxH+cPtDkR//JJ7kmyt04OGvVymB1XtHON+5C69v2Tin8pIOw9qjtBfCjwoyPOgAT2bTq5NJz+dLns8qK31AkoDpbCum2ZZsPmy9mf2hlm/lJaAUgS01hl/xfLlrLeEdgA0vb/RQPN+CGh0d5mFAQNqWouDB7RuyX/1eV5PZ3tAc/ePCVBqfpcIaL4209WZu3+VgGZYMHao8xF8bTHgBQHNlwPodw/evXr1vf/M6UaifQdU/JuKAuWcYTWA0laAurCWAaoNDBfQxa9Vc/XNLET7DKhQLwBtMN0IaCQz9MIBujgklz9nH57cCL6aydOFAzS0p2stpMRA4BdykQA91ljWqK60Lz53f78ADe9ZJ6CB4zMBhR+HCijrh1ef51kuFAHNMICAdpL1jnrTvbnivvjc/UsAtOsZ+g9ocTUaAdXaOKDdE/Qd0AwDCGhUCOhqAW06g52OIqCuRgFofM+GAc1N4IYBBgzo50+lvkJAG/cPEVCu4QIKZg8u+/WL7fYjoBn7Lwygiy8+A+q0HLcSAoqAdtRoB4us/gwI6DpUDChYqhMB7WqgYw4yE1woQF/dexsBFdqUA+xsYNSAnv4DelCpTTnAzgbGDOj3v/g/BHToBkYM6Kt7H6k6aM5qx6heasSAnu5hI2n4BsYL6Pe/+AsCOnwD4wX0dJcre7XjATy8AWQRAS0SetDBG0BAtfr/8AaQRQS0SAjo4A2MG1Co+6hBalnwrEOdAO2szreq+73efBY2b6DPQkDRQK+FgKKBXmuzgKJQDUJAUb0WAorqtRBQVK+FgKJ6LQQU1WutGdCXd3Z3f/yX+sPR7u473/ItvxRdp+pvSwN6e2sLr+7t7n7Y7RqsfuByA9//fFdtaJmDo7zjh6T1Avryzl59F+t7ePrOt6/u7bFNR3IS3tHbec82bEBvb5+Fo716XwahiWuwZhSWG3ieCVf8Ej7MvAkD0noBfc7uY+1mXt75qP5SO4HaF7wtHWAWoDEDant7C/zg04ynG70GZ0ZhuYHTveaDGy8hz4kPRxuog9a3kN9Fdn+f74kbqv62NiC3d7SQA2jcgD2jsNzAUVYNI24g1wMPShsAtC6E2M+e31pDVQGgYQMlpVvEgvja1gCYUdjKwMs7/5Zbjw4bON17XmBgIFo/oKd1aSRvLfMY5YBGDPDtXSzUraRcwoMGnBmFxQa+//mHYtpXWwNHu3vjc6NrB/R0V1ac2nrQmIHT3Vz3F7MgN7Y04M4obJeDTCceNMBLkPxSYBhaN6CiualrT+WAxgzkRQGSWch9umED7ozCDeRgL9vAcLRmQE+Fi9Ltz2JAYwZOs+teEQvAHbW+hsyLSOYgJxzc2cCAtF5A9QM80hG8MkBjBooa8EELdRMnrwKXuIa8bKwsB6/ufVgQiBiI1guoKQaPdndF1K8M0JiB/PI1mgXWk5TzcBPXkHcRUQOsg6hTDnIvYUjCvnhUr4WAonotBBTVayGgqF4LAUX1WggoqtdCQFG9FgKK6rUQUFSvhYCiei0EtNaM7KgPB5vNCcoVAkr5QuR8bec52d50VlCOEFCmY07m4nByd9M5QTlCQJkWh6xsP1YlPao/QkC5zqZXnp3vX3nGPr/4NSGTW/zj49fFx8Xh9jHZerjZPF5MIaBCM3L7WLSQzqaEiZX5x/xT7VcXh5emROCLWq8QUKHz/UtT0UKakbdql/lpTWvddqqd5lntWOsqAJb+mxECKjUnoiV/JjitC3X25+lnv3mdMEDFTtTahYBKne8LBypLeMJKdPmZAYrl+4aEgEp5gG49Ot8n12794at9BHSDQkClDKC6tjnnraZzBHSTQkClFKCLw8kHNYyP66ronGw/oy9uYBG/SSGgUgpQVcZP7tabVGGPgG5MCKiUBpQH6sl1FpWvvSe5dHs2uYuAbkwIKKrXQkBRvRYCiuq1EFBUr4WAonotBBTVayGgqF4LAUX1Wggoqtf6fxxagX8bENi3AAAAAElFTkSuQmCC" /><!-- --></p>
<p><strong>Baseline predicted</strong> - A fit of the cyclical regression model, (one Fourier term). <strong>Deaths</strong> - No. of influenza / pneumonia deaths per 100,000 people. <strong>Serfling Threshold</strong> The fitted line + 1.64 standard deviations. <strong>95% PI</strong> - upper 95% prediction interval.</p>
</div>
</div>
<div id="step-3.-compute-excess-deaths" class="section level3">
<h3>Step 3. Compute excess deaths</h3>
<p>The next step is to compute the no. of deaths in excess of the epidemic threshold. In addition to being in excess, Serfling and others apply a rule that values are counted starting from two consecutive timepoints exceeding the threshold, then stopped after two timepoints below the threshold. For this exercise we will use the 95% prediction interval.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_epi &lt;-<span class="st"> </span>df_base <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">threshold =</span> <span class="kw">if_else</span>(fludeaths <span class="op">&gt;</span><span class="st"> </span>pred_y0_uci, T, F),
         <span class="dt">epidemic =</span> <span class="kw">if_else</span>(threshold<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span><span class="kw">lead</span>(threshold)<span class="op">==</span>T, T, <span class="ot">NA</span>),
         <span class="dt">epidemic2 =</span> <span class="kw">if_else</span>(<span class="kw">lag</span>(epidemic)<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span>threshold<span class="op">==</span>T, T, epidemic),
         <span class="dt">epidemic3 =</span> <span class="kw">if_else</span>(<span class="kw">lag</span>(epidemic2)<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span><span class="kw">lead</span>(threshold)<span class="op">==</span>T, T, epidemic2),
         <span class="dt">epidemic4 =</span> <span class="kw">if_else</span>(<span class="kw">lag</span>(epidemic3)<span class="op">==</span>T <span class="op">&amp;</span><span class="st"> </span>threshold<span class="op">==</span>T, T, epidemic3),
         <span class="dt">epidemic5 =</span> <span class="kw">coalesce</span>(epidemic4, F)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">epidemic =</span> <span class="kw">if_else</span>(<span class="kw">sum</span>(epidemic, epidemic2, epidemic3, 
                                   epidemic4, epidemic5, <span class="dt">na.rm=</span>T)<span class="op">&gt;</span><span class="dv">0</span>, T, F),
         <span class="dt">excess =</span> <span class="kw">if_else</span>(epidemic<span class="op">==</span>T, fludeaths <span class="op">-</span><span class="st"> </span>pred_y0_uci, <span class="dv">0</span>))
df_epi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(year, week, threshold, epidemic, excess)
<span class="co">#&gt; Source: local data frame [351 x 5]</span>
<span class="co">#&gt; Groups: &lt;by row&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 351 x 5</span>
<span class="co">#&gt;    year  week threshold epidemic    excess</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;     &lt;lgl&gt;    &lt;lgl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1  2010     1     FALSE    FALSE 0.0000000</span>
<span class="co">#&gt; 2  2010     2      TRUE     TRUE 0.4515476</span>
<span class="co">#&gt; 3  2010     3      TRUE     TRUE 0.1133415</span>
<span class="co">#&gt; 4  2010     4     FALSE    FALSE 0.0000000</span>
<span class="co">#&gt; # ... with 347 more rows</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="criticisms-of-this-approach" class="section level2">
<h2>Criticisms of this approach</h2>
<p>We see the following problems with this approach the reader should consider:</p>
<ul>
<li><p>The authors view the concept as sound, but its implementation in the original work is somewhat dated given modern computing methods. The constrains of needing an easy to estimate linear model are no longer relevant to the modern analyst. More elegant models (e.g. ARIMA) are available to the modern analyst.</p></li>
<li><p>Additionally the approach is dependent on an accurate baseline period. Whether to include mild or known epidemic seasons, which cut-off to define as the influenza season (e.g. week 40 - week 20) are important but subjective decisions the analyst must make.</p></li>
<li><p>The selected threshold for what constitutes “excess” is somewhat arbitrary. The original Serfling paper describes 1.64 standard deviations for 2 or more weeks as criteria. There is no empirical evidence given for this, but a threshold is needed and the argument is pragmatic and logical. Recent papers have used the 95% prediction interval.</p></li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
