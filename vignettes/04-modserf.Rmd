---
title: "Modified Serfling Models"
author: "Kevin W. McConeghy"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{flumodelr: 04-Modified Serfling}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(tibble.print_min = 4L, tibble.print_max = 4L)
library(dplyr)
library(ggplot2)
library(lubridate)
library(scales)
library(flumodelr)
library(tibble)
```

```{r, results='asis', fig.width=7}
flu_ex <- flumodelr::flu_ex
```

## Virology data  

In current methods, most researchers incorporate data on the percent of isolates positive with influenza viral types. This is publically available in many cases see `?nrevss`. The data describes the proportion of isolates tested, which may be obtained from participating hospital and outpatient settings. Using this surrogate time-periods of high flu activity can be used to inform spikes in influenza activity, increasing confidence that deaths are influenza related and estimated influenza morbidity and mortality.  

```{r, echo=F, results='as.is', fig.width=7.0}
ggplot(flu_ex, aes(x=yrweek_dt)) + 
  geom_line(aes(y=prop_flupos)) +
  scale_x_date(labels = date_format("%Y"), date_breaks="1 year",
               expand=c(0, .9)) + 
  xlab("Year") + 
  ylab("Proportion of influenza (+) isolates") + 
  theme_light(base_size=16)
```

In light of this the above model can be modified like so:

$$Eq \ 3. \  y = \alpha_0 + \beta_1*t + \beta_2*Flu_t + sine(\frac{2 \pi t}{52}) + cos(\frac{2 \pi t}{52}) + u$$
Where Flu = no. of isolates positive for influenza / total isolates tested in a given timepoint t.  

Many published examples of this exist. Some authors include data on the % RSV (+), as well as breakdown influenza by subtype and even include data on weather, humidity etc.  

See [@Wang2012, @Matias2016]